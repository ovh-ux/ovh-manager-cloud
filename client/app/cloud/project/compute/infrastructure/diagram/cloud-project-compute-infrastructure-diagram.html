<!-- init loading -->
<div class="text-center" style="margin-top: 200px;"
     data-ng-if="ComputeInfrastructureDiagramCtrl.loaders.init">
    <oui-spinner size="l" inline="true"></oui-spinner>
</div>

<!-- error -->
<div class="alert alert-danger text-center"
     data-ng-if="!ComputeInfrastructureDiagramCtrl.loaders.init && ComputeInfrastructureDiagramCtrl.errors.init">
    <p>
        <span class="fa fa-bug" aria-hidden="true"></span>
        <strong data-translate="cpci_errors_init_title"></strong>
    </p>
    <p>
        <span data-translate="cpci_errors_init_help1"></span>
        <button type="button" class="btn btn-default btn-xs"
                data-ng-click="ComputeInfrastructureDiagramCtrl.init();">
            <span class="fa fa-refresh" aria-hidden="true"></span>
            <span data-ng-bind="'common_refresh' | translate"></span>
        </button>
    </p>
    <br>
    <p data-translate="cpci_errors_init_help3" data-translate-values="{ url: ComputeInfrastructureDiagramCtrl.REDIRECT_URLS.support }"></p>
</div>

<div class="cloud-compute-infra" id="cloud-project-compute-infrastructure"
     data-ng-if="!ComputeInfrastructureDiagramCtrl.loaders.init && !ComputeInfrastructureDiagramCtrl.errors.init">
    <div class="row">
        <div class="col-xs-3">
            <div class="btn-group cloud-compute-infra-primary-actions">
                <button type="button" class="oui-button oui-button_dropdown dropdown-toggle" aria-haspopup="true" aria-expanded="false"
                        data-ng-disabled="ComputeInfrastructureDiagramCtrl.loaders.vRack"
                        data-toggle="dropdown"
                        write-right-required>
                    <span data-ng-bind=":: 'common_actions' | translate"></span>
                    <span class="oui-icon oui-icon-chevron-down" aria-hidden="true"></span>
                </button>
                <ul class="dropdown-menu mt-0">
                    <li>
                        <button type="button" class="btn fs14"
                                data-ng-click="ComputeInfrastructureDiagramCtrl.addVirtualMachine()"
                                at-internet-click="{ name : 'cloud-project::cloud-project-compute::cloud-project-compute-infrastructure-add-virtual-machine' }"
                                data-ng-bind=":: 'cpci_add_server' | translate">
                        </button>
                    </li>
                    <li>
                        <button type="button" class="btn fs14"
                                at-internet-click="{ name : 'cloud-project::cloud-project-compute::cloud-project-compute-infrastructure-add-volume' }"
                                data-ng-click="ComputeInfrastructureDiagramCtrl.addVolume()"
                                data-ng-bind=":: 'cpci_volume_add' | translate">
                        </button>
                    </li>
                    <li class="divider"></li>
                    <li role="menuitem">
                        <button type="button"
                                class="btn fs14"
                                data-ui-sref="iaas.pci-project.compute.infrastructure.iac-view"
                                data-at-internet-click="{
                                    name: 'cloud-project::cloud-project-compute::cloud-project-compute-infrastructure-add-view'
                                }"
                                data-ng-bind=":: 'cpci_view_iac' | translate ">
                       </button>
                    </li>
                    <li class="divider" role="presentation"></li>
                    <li>
                        <button type="button" class="btn fs14"
                                data-ng-click="ComputeInfrastructureDiagramCtrl.importIpFailover()"
                                data-ng-bind=":: 'cpci_import_ip_failover' | translate">
                        </button>
                    </li>
                    <li>
                        <button type="button" class="btn fs14"
                                data-ng-click="ComputeInfrastructureDiagramCtrl.InfrastructureService.buyIpFailOver()"
                                at-internet-click="{ name : 'cloud-project::cloud-project-compute::cloud-project-compute-infrastructure-buy-ip' }"
                                data-ng-bind=":: 'cpci_buy_ip_failover' | translate">
                        </button>
                    </li>
                    <li class="divider"
                        data-ng-if="ComputeInfrastructureDiagramCtrl.TARGET === 'US'">
                    </li>
                    <li data-ng-if="ComputeInfrastructureDiagramCtrl.TARGET === 'US'">
                        <button type="button"
                                class="btn fs14"
                                data-ng-click="ComputeInfrastructureDiagramCtrl.InfrastructureService.orderCredit()"
                                data-translate="cpb_vouchers_add_credit_title">
                        </button>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <button type="button" class="btn fs14"
                                data-ng-click="ComputeInfrastructureDiagramCtrl.InfrastructureService.openDeleteProjectModal()"
                                at-internet-click="{ name : 'cloud-project::cloud-project-compute::cloud-project-compute-infrastructure-delete-project' }"
                                data-ng-bind=":: 'cpb_details_project_delete' | translate"
                                write-right-required>
                        </button>
                    </li>
                </ul>
            </div>
        </div>
        <div class="col-xs-9 text-right">
            <div class="d-inline-block">
                <span class="oui-label align-middle d-inline-block mb-0 mr-3"
                      data-translate="cpci_menu_view_label"></span>
                <nav class="oui-button-group align-middle mb-0">
                    <a class="oui-button oui-button_primary"
                       ui-sref="iaas.pci-project.compute.infrastructure.diagram()"
                       data-translate="cpci_menu_view_diagram"></a>
                    <a class="oui-button oui-button_secondary"
                       ui-sref="iaas.pci-project.compute.infrastructure.list()"
                       data-translate="cpci_menu_view_list"></a>
                </nav>
            </div>
        </div>
    </div>

    <div class="cloud-compute-infra-ctnr">
        <div class="row" id="infra-ctnr"
             data-jsplumb-instance>

            <!-- vRack - Private Networks -->
            <div class="col-xs-4 private-network-container">
                <private-network-list class="col-xs-12 col-lg-10"></private-network-list>
            </div>

            <!-- vRack -->
            <div class="col-xs-4">

                <div id="infra-vrack-ctnr">

                    <!-- Public Cloud -->
                    <div class="infra-vrack-public-ctnr">

                        <!-- Unlink Volume -->
                        <div class="volume-content-unlinked cuc-highlighted-element"
                             data-ng-class="{ hasCurrentDroppableVolume : ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDraggedVolume}"
                             data-ng-if="!ComputeInfrastructureDiagramCtrl.loaders.vRack"
                             data-droppable
                             data-droppable-id="unlinked"
                             data-droppable-info="{'group':'unlinkedVolumes'}"
                             data-droppable-options="{{ComputeInfrastructureDiagramCtrl.droppableOptions.unlinked}}"
                             data-cuc-highlighted-element="unlinked_volumes">

                            <div class="volume-resume"
                                 data-ng-style="(ComputeInfrastructureDiagramCtrl.helpDisplay.openUnlinkVolume || ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDroppableVmId === 'unlinked') && {'border-bottom' : 'none'}">
                                <button type="button" class="vm-collapse-button no-style"
                                        data-ng-click="ComputeInfrastructureDiagramCtrl.toggleCollapsedVolumes()">
                                    <span class="fa fa-caret-right rotate right-space-m8"
                                          data-ng-class="{ 'rotate90': ComputeInfrastructureDiagramCtrl.helpDisplay.openUnlinkVolume }"
                                          data-ng-if="ComputeInfrastructureDiagramCtrl.volumes.unlinked.length"></span>
                                    <span translate="cpci_volume_number_detach_zero"
                                          data-ng-if="!ComputeInfrastructureDiagramCtrl.volumes.unlinked.length"></span>
                                    <span translate="cpci_volume_number_detach_one"
                                          data-ng-if="ComputeInfrastructureDiagramCtrl.volumes.unlinked.length === 1"></span>
                                    <span translate="cpci_volume_number_detach_other"
                                          data-translate-values="{nbVolume: ComputeInfrastructureDiagramCtrl.volumes.unlinked.length}" data-ng-if="ComputeInfrastructureDiagramCtrl.volumes.unlinked.length > 1"></span>
                                    <span class="ovh-font ovh-font-add-disk pull-right" style="margin-top: 2px;" title="{{ 'cpci_volume_add'|translate }}"
                                          data-ng-if="!ComputeInfrastructureDiagramCtrl.volumes.unlinked.length"
                                          write-right-required></span>
                                </button>
                            </div>

                            <div class="volume-detail"
                                 data-ng-show="(ComputeInfrastructureDiagramCtrl.helpDisplay.openUnlinkVolume ||
                                    ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDroppableVmId === 'unlinked') &&
                                    ComputeInfrastructureDiagramCtrl.volumes.unlinked.length">

                                <!-- Loop over regions -->
                                <ul class="volume-content-unlinked-regions">

                                    <li class="volume-detail-region"
                                        data-ng-repeat="listedRegion in ComputeInfrastructureDiagramCtrl.getUnlinkedVolumesRegions() | orderBy:'toString()'">
                                        <span class="region-label"
                                              data-ng-bind="::ComputeInfrastructureDiagramCtrl.CucRegionService.getTranslatedMicroRegion(listedRegion)"></span>

                                        <!-- Loop over volumes in current listed region -->
                                        <ul class="volume-content-unlinked-items clearfix">

                                            <li class="volume-detail-item volume-detail-item-{{volume.region}} cuc-highlighted-element"
                                                data-draggable
                                                data-draggable-disabled="{{volume.getStatusGroup() !== 'ACTIVE'
                                                    || volume.openDetail
                                                    || ComputeInfrastructureDiagramCtrl.volumeEdit.action === 'moveCheckbox'
                                                    || ComputeInfrastructureDiagramCtrl.model.currentLinkEdit !== null
                                                }}"
                                                data-draggable-id="{{volume.id}}"
                                                data-draggable-info="{'volume':{{volume}}, 'srcVmId':'unlinked'}"
                                                data-draggable-options="{{ComputeInfrastructureDiagramCtrl.draggableOptions.unlinked}}"
                                                data-draggable-src-cloned-class="volume-detail-item-helper"
                                                data-cuc-highlighted-element="{{volume.id}}"
                                                data-ng-class="{
                                                    'visibility-hide' : !ComputeInfrastructureDiagramCtrl.dragDropHelper.draggingIsDoing && ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDraggedVolume.draggableInfo.volume.id === volume.id,
                                                    'opacity5' : volume.getStatusGroup() === 'DRAFT'
                                                }"
                                                data-ng-repeat="volume in ComputeInfrastructureDiagramCtrl.volumes.unlinked | filter:{ region: listedRegion }">

                                                <button type="button" class="btn volume-detail-item-illustration"
                                                     data-ng-click="ComputeInfrastructureDiagramCtrl.model.currentLinkEdit === null
                                                        && ComputeInfrastructureDiagramCtrl.volumeEdit.action !== 'moveCheckbox'
                                                        && ComputeInfrastructureDiagramCtrl.toggleVolumeEditionState(volume)"
                                                     data-popover-class="cloud-popover cloud-vm-popover-volume"
                                                     data-popover-is-open="volume.openDetail"
                                                     data-popover-enable="volume.getStatusGroup() === 'ACTIVE' || volume.getStatusGroup() === 'DRAFT'"
                                                     data-popover-placement="right"
                                                     data-popover-append-to-body="true"
                                                     data-popover-trigger="none"
                                                     data-responsive-popover="'app/cloud/project/compute/infrastructure/volume/addEdit/cloud-project-compute-infrastructure-volume-addEdit.html'"
                                                     data-uib-tooltip="{{ volume.name + ' (' + volume.region + ')' }}">

                                                    <span class="d-block"
                                                          data-ng-class="{'opacity2' : volume.getStatusGroup() !== 'ACTIVE' && volume.getStatusGroup() !== 'DRAFT'}">
                                                        <span data-ng-if="volume.type==='high-speed'">
                                                            <span class="ovh-font ovh-font-harddiskspeed"></span>
                                                        </span>
                                                        <span data-ng-if="volume.type==='classic'">
                                                            <span class="ovh-font ovh-font-harddisk"></span>
                                                        </span>
                                                    </span>
                                                    <span class="d-block text-center"
                                                          data-ng-if="volume.getStatusGroup() !== 'ACTIVE' && volume.getStatusGroup() !== 'DRAFT'">
                                                        <oui-spinner size="s" inline="true"></oui-spinner>
                                                    </span>
                                                </button>

                                                <div class="volume-detail-item-info">
                                                    <div class="btn-group"
                                                         data-uib-dropdown
                                                         data-is-open="volume.isopen">
                                                        <button type="button" class="no-style no-space"
                                                                data-uib-dropdown-toggle
                                                                data-ng-disabled="volume.openDetail ||
                                                                ComputeInfrastructureDiagramCtrl.model.currentLinkEdit !== null ||
                                                                ComputeInfrastructureDiagramCtrl.volumeEdit.action === 'moveCheckbox' ||
                                                                (volume.getStatusGroup() !== 'ACTIVE' && volume.getStatusGroup() !== 'DRAFT')">
                                                            <span class="ovh-font ovh-font-bootDisk" title="{{::'common_disk_bootable' | translate}}"
                                                                  data-ng-if="volume.bootable"></span>
                                                            <span class="vertical-middle">{{volume.size | bytes:2:true:'GiB'}}</span>
                                                            <i class="glyphicon glyphicon-menu-down"
                                                               write-right-required></i>
                                                        </button>
                                                        <ul class="dropdown-menu" role="menu"
                                                            data-uib-dropdown-menu
                                                            write-right-required>
                                                            <li data-ng-if="volume.getStatusGroup() !== 'DRAFT'">
                                                                <button type="button"
                                                                        data-ng-click="ComputeInfrastructureDiagramCtrl.volumeEdit.moveCheckbox.launchConfirm(volume)">
                                                                    <span class="fa fa-link right-space-m8" aria-hidden="true"></span>
                                                                    <span data-ng-bind="'cpci_volume_attach' | translate"></span>
                                                                </button>
                                                            </li>
                                                            <li class="divider"
                                                                data-ng-if="volume.getStatusGroup() !== 'DRAFT'"></li>
                                                            <li>
                                                                <button type="button"
                                                                        data-ng-click="ComputeInfrastructureDiagramCtrl.model.currentLinkEdit === null && ComputeInfrastructureDiagramCtrl.toggleVolumeEditionState(volume)">
                                                                    <span class="fa fa-edit right-space-m8" aria-hidden="true"></span>
                                                                    <span data-ng-bind="'cpci_vm_action_edit' | translate"></span>
                                                                </button>
                                                            </li>
                                                            <li>
                                                                <button type="button"
                                                                        data-ng-click="ComputeInfrastructureDiagramCtrl.model.currentLinkEdit === null && ComputeInfrastructureDiagramCtrl.toggleVolumeEditionState(volume, 'NAME')">
                                                                    <span class="fa fa-caret-right right-space-m8 left-space-m8" aria-hidden="true"></span>
                                                                    <span data-ng-bind="'cpci_vm_action_edit_name' | translate"></span>
                                                                </button>
                                                            </li>
                                                            <li>
                                                                <button type="button"
                                                                        data-ng-click="ComputeInfrastructureDiagramCtrl.model.currentLinkEdit === null && ComputeInfrastructureDiagramCtrl.toggleVolumeEditionState(volume, 'SIZE')">
                                                                    <span class="fa fa-caret-right right-space-m8 left-space-m8"></span>
                                                                    <span data-ng-bind="'cpci_vm_action_edit_size' | translate"></span>
                                                                </button>
                                                            </li>
                                                            <li>
                                                                <button type="button"
                                                                        data-ng-click="ComputeInfrastructureDiagramCtrl.openVolumeSnapshotWizard(volume)">
                                                                    <span class="fa fa-floppy-o right-space-m8" aria-hidden="true"></span>
                                                                    <span data-ng-bind="'cpci_volume_action_backup' | translate"></span>
                                                                </button>
                                                            </li>
                                                            <li class="divider"></li>
                                                            <li>
                                                                <button type="button" class="red"
                                                                        data-ng-click="ComputeInfrastructureDiagramCtrl.volumeEdit.remove.launchConfirm(volume)">
                                                                    <span class="fa fa-trash-o right-space-m8" aria-hidden="true"></span>
                                                                    <span data-ng-bind="'cpci_volume_delete' | translate"></span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </li>

                                            <li class="volume-detail-item"
                                                data-ng-show="ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDroppableVmId === 'unlinked'
                                                    && ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDraggedVolume.draggableInfo.srcVmId !== 'unlinked'
                                                    && ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDraggedVolume.draggableInfo.volume.region ===  listedRegion">
                                                <div>
                                                    <div data-ng-if="ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDraggedVolume.draggableInfo.volume.type==='high-speed'">
                                                        <span class="ovh-font ovh-font-harddiskspeed"></span>
                                                    </div>
                                                    <div data-ng-if="ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDraggedVolume.draggableInfo.volume.type==='classic'" style="padding-top:5px;">
                                                        <span class="ovh-font ovh-font-harddisk"></span>
                                                    </div>
                                                </div>

                                                <div class="volume-detail-item-info">
                                                    <span data-ng-bind="ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDraggedVolume.draggableInfo.volume.size | bytes:2:true:'GiB'"></span>
                                                </div>
                                            </li>
                                        </ul>
                                    </li>

                                    <!-- legend for bootable disks -->
                                    <li class="list-unstyled clearfix">
                                        <div class="fs10 pull-right opacity7">
                                            <span class="ovh-font ovh-font-bootDisk vertical-middle legend" aria-hidden="true"></span>
                                            <span class="left-space-m4 vertical-middle"
                                                  data-ng-bind="::'common_disk_bootable' | translate"></span>
                                        </div>
                                    </li>
                                </ul>

                            </div>
                        </div>



                        <div class="infra-vrack-public-title clearfix">
                            <h3 class="pull-left fs16 top-space-m4 bottom-space-m4" data-translate="cpci_public_cloud"></h3>
                            <div class="pull-right">

                                <button type="button" class="no-style no-space vertical-middle left-space-m8"
                                        data-ng-click="ComputeInfrastructureDiagramCtrl.unCollapseAll('publicCloud')"
                                        data-uib-tooltip="{{'cpci_uncollapse_all_vms'|translate}}"
                                        data-tooltip-append-to-body="true">
                                    <span class="wrap">
                                        <span class="wrap2"></span>
                                        <span class="wrap2"></span>
                                    </span>
                                </button>

                                <button type="button" class="no-style no-space vertical-middle"
                                        data-ng-click="ComputeInfrastructureDiagramCtrl.collapseAll()"
                                        data-uib-tooltip="{{'cpci_collapse_all_vms'|translate}}"
                                        data-tooltip-append-to-body="true">
                                    <span class="wrap">
                                        <span class="wrap3"></span>
                                        <span class="wrap3"></span>
                                        <span class="wrap3"></span>
                                    </span>
                                </button>
                            </div>
                        </div>



                        <!-- Public Cloud: VMs list -->
                        <div class="infra-vrack-public-content">

                            <!-- Loading list... -->
                            <div class="text-center animate-fadeIn-enter"
                                 data-ng-if="ComputeInfrastructureDiagramCtrl.loaders.vRack">
                                <oui-spinner size="s" inline="true"></oui-spinner>
                            </div>

                            <div class="animate-fadeIn-enter"
                                 data-ng-if="!ComputeInfrastructureDiagramCtrl.loaders.vRack && !ComputeInfrastructureDiagramCtrl.infra.vrack.publicCloud.length()">
                                <p data-translate="cpci_empty_project"></p>
                            </div>


                            <div class="public-vm-list"
                                 data-ng-if="!ComputeInfrastructureDiagramCtrl.loaders.vRack"
                                 data-ng-model="ComputeInfrastructureDiagramCtrl.infra.vrack.publicCloud.sortedKeys"
                                 data-ui-sortable="ComputeInfrastructureDiagramCtrl.vmSortableOptions">

                                <!-- VM -->
                                <div class="cloud-vm public-cloud-vm cuc-highlighted-element{{vm.status}}"
                                     data-ng-class="{
                                        'collapsed': vm.collapsed,
                                        'pointer': (vm.status === 'DRAFT' || vm.status === 'ACTIVE')
                                            && ComputeInfrastructureDiagramCtrl.volumeEdit.action !== 'moveCheckbox'
                                            && ComputeInfrastructureDiagramCtrl.model.currentLinkEdit === null,
                                        'sortable-disabled': !!ComputeInfrastructureDiagramCtrl.model.currentLinkEdit || ComputeInfrastructureDiagramCtrl.volumeEdit.action === 'moveCheckbox'
                                    }"
                                     data-ng-if="!ComputeInfrastructureDiagramCtrl.loaders.vRack && ComputeInfrastructureDiagramCtrl.infra.vrack.publicCloud.length()"
                                     data-ng-init="vm = ComputeInfrastructureDiagramCtrl.infra.vrack.publicCloud.get(vmKey)"
                                     data-ng-mouseenter="ComputeInfrastructureDiagramCtrl.highlightInstanceAndPublicIP($event)"
                                     data-ng-mouseleave="ComputeInfrastructureDiagramCtrl.removeAllFades()"
                                     data-ng-repeat="vmKey in ComputeInfrastructureDiagramCtrl.infra.vrack.publicCloud.sortedKeys"
                                     data-droppable
                                     data-droppable-disabled="{{ vm.getStatusGroup() !== 'ACTIVE' }}"
                                     data-droppable-info="{'group':'linkedVolumes'}"
                                     data-droppable-id="{{vm.id}}"
                                     data-droppable-options="{{ { accept : ComputeInfrastructureDiagramCtrl.droppableOptions.vmUnlinked(vm) } }}"
                                     data-cuc-highlighted-element="vm,{{vm.id}},vm-{{vm.getStatusGroup()}},vm-{{vm.getStatusGroup()}}-{{vm.region}},vm-{{vm.getStatusGroup()}}-{{ComputeInfrastructureDiagramCtrl.getVmContinent(vm)}}"
                                     data-instance-id="{{:: vm.id }}">

                                    <!-- loadings -->
                                    <div class="vm-pending-ctnr animate-fadeIn-enter animate-fadeOut-leave"
                                         data-ng-if="(vm.status !== 'DRAFT' && vm.status !== 'ACTIVE' && !vm.confirmLoading)">

                                        <div class="pending-overlay"></div>

                                        <div class="pending-content top-space-p8 bottom-space-p8"
                                             data-ng-class="{'vm-collapsed': vm.collapsed, 'vm-expanded': !vm.collapsed}"
                                             data-ng-switch="vm.getStatusGroup()">

                                            <!-- dropdown -->
                                            <div class="vm-actions-dropdown btn-group"
                                                 data-uib-dropdown
                                                 data-is-open="isOpen">

                                                <button type="button" class="no-style dropdown-toggle"
                                                        data-ng-disabled="vm.openDetail
                                                            || ComputeInfrastructureDiagramCtrl.model.currentLinkEdit !== null
                                                            || ComputeInfrastructureDiagramCtrl.volumeEdit.action === 'moveCheckbox'"
                                                        data-uib-dropdown-toggle
                                                        write-right-required>
                                                    <i class="glyphicon glyphicon-menu-down"></i>
                                                </button>

                                                <ul class="dropdown-menu" role="menu"
                                                    data-uib-dropdown-menu>
                                                    <li data-ng-if="vm.status === 'RESCUE' && vm.getStatusGroup() === 'OPENSTACK'">
                                                        <button type="button"
                                                                data-ng-click="ComputeInfrastructureDiagramCtrl.InfrastructureService.openVnc(vm)">
                                                            <span class="fa fa-desktop right-space-m8" aria-hidden="true"></span>
                                                            <span data-ng-bind=":: 'cpci_vm_action_vnc' | translate"></span>
                                                        </button>
                                                    </li>
                                                    <li data-ng-if="vm.status === 'RESCUE' && vm.getStatusGroup() === 'OPENSTACK'">
                                                        <button type="button" class="red"
                                                                data-ng-click="ComputeInfrastructureDiagramCtrl.InfrastructureService.stopRescueMode(vm, false)">
                                                            <span class="fa fa-power-off right-space-m8" aria-hidden="true"></span>
                                                            <span data-ng-bind="'cpci_vm_action_rescue_end' | translate"></span>
                                                        </button>
                                                    </li>
                                                    <li data-ng-if="vm.status === 'SUSPENDED' && vm.getStatusGroup() === 'OPENSTACK'">
                                                        <button type="button"
                                                                data-ng-click="ComputeInfrastructureDiagramCtrl.InfrastructureService.resumeVirtualMachine(vm)">
                                                            <span class="fa fa-power-off right-space-m8" aria-hidden="true"></span>
                                                            <span data-ng-bind="'cpci_vm_action_resume' | translate"></span>
                                                        </button>
                                                    </li>
                                                    <li data-ng-if="vm.status !== 'RESCUE' && vm.getStatusGroup() === 'OPENSTACK'">
                                                        <button type="button" class="red"
                                                                data-ng-click="ComputeInfrastructureDiagramCtrl.InfrastructureService.rebootVirtualMachine(vm, 'hard')">
                                                            <span class="fa fa-power-off right-space-m8" aria-hidden="true"></span>
                                                            <span data-ng-bind="'cpci_vm_action_reboot_hard' | translate"></span>
                                                        </button>
                                                    </li>
                                                    <li class="divider"
                                                        data-ng-if="vm.getStatusGroup() === 'OPENSTACK'"></li>
                                                    <li>
                                                        <button type="button" class="red"
                                                                data-ng-click="ComputeInfrastructureDiagramCtrl.deleteConfirmPending(vm)">
                                                            <span class="fa fa-trash-o right-space-m8" aria-hidden="true"></span>
                                                            <span data-ng-bind="'cpci_vm_action_delete' | translate"></span>
                                                        </button>
                                                    </li>
                                                </ul>
                                            </div>

                                            <div class="vm-states vcenter"
                                                 data-ng-switch-when="PENDING">
                                                <div class="text-center">
                                                    <oui-spinner size="s" inline="true"></oui-spinner>
                                                </div>
                                                <p class="no-space text-info"
                                                   data-translate="{{:: 'cpci_vm_' + vm.status }}"></p>
                                            </div>
                                            <div class="vm-states"
                                                 data-ng-switch-when="OPENSTACK">
                                                <span class="ovh-font ovh-font-openstack text-warning" aria-hidden="true"></span>
                                                <p class="no-space text-warning"
                                                   data-translate="{{:: 'cpci_vm_' + vm.status }}"
                                                   data-translate-values="{'msg': vm.status, 'server': vm.name, 'id': vm.id}"></p>
                                            </div>
                                            <div class="vm-states"
                                                 data-ng-switch-when="ERROR">
                                                <span class="fa fa-heartbeat text-danger" aria-hidden="true"></span>
                                                <p class="no-space text-danger"
                                                   data-translate="cpci_vm_ERROR"
                                                   data-translate-values="{'server': vm.name, 'id': vm.id}"></p>
                                            </div>
                                            <div class="vm-states"
                                                 data-ng-switch-default>
                                                <span class="fa fa-bug text-warning" aria-hidden="true"></span>
                                                <p class="no-space text-warning"
                                                   data-translate="cpci_vm_UNKNOWN_ERROR"
                                                   data-translate-values="{'msg': vm.status, 'server': vm.name, 'id': vm.id}">
                                                </p>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- VM infos -->
                                    <div class="vm-infos fade-transition"
                                         data-ng-class="{'show-problem': (vm.status !== 'DRAFT' && vm.status !== 'ACTIVE' && !vm.confirmLoading)}"
                                         data-instance-id="{{vm.id}}">

                                        <div class="vm-display-actions clearfix">
                                            <div class="vm-grip pull-left" data-ovh-stop-event="click">
                                                <span class="ovh-font ovh-font-grip vertical-middle opacity5"></span>
                                            </div>
                                            <button type="button" class="vm-collapse-button no-style pull-left"
                                                    data-ng-click="ComputeInfrastructureDiagramCtrl.toggleCollapsedState(vm)"
                                                    data-ovh-stop-event="click">
                                                <span class="fa fa-caret-down rotate"
                                                      data-ng-class="{ 'rotate-90': vm.collapsed }"></span>
                                            </button>
                                        </div>

                                        <!-- flavor -->
                                        <div class="vm-flavor flavor-{{vm.flavor.type}} hidden-collapsed"
                                             data-ng-if="vm.flavor.name">
                                            <div class="flavor-offer-type right-space-m12">
                                                <span class="ovh-font {{vm.flavor.typeGeneric | infrastructureFlavor:'icon'}}"></span>
                                                <span translate="cpci_vm_flavor_category_{{vm.flavor.name}}" translate-default="?"></span>
                                            </div>
                                            <span class="flavor-offer-price right-space-m12"
                                                  data-ng-if="vm.status !== 'DRAFT' && !vm.monthlyBillingBoolean"
                                                  data-translate="cpci_vm_flavor_price"
                                                  data-translate-values="{price: vm.price.price.text || '?' }"></span>
                                            <span class="flavor-offer-price right-space-m12"
                                                  data-ng-if="vm.status !== 'DRAFT' && vm.monthlyBillingBoolean"
                                                  data-translate="cpci_vm_flavor_month"
                                                  data-translate-values="{price: vm.price.monthlyPrice.text || vm.price.price.text || '?' }"></span>
                                            <oui-spinner size="s" inline="true"
                                                         data-ng-if="vm.monthlyBilling.status === 'activationPending'"></oui-spinner>
                                        </div>

                                        <!-- dropdown -->
                                        <div class="vm-actions-dropdown btn-group"
                                             data-uib-dropdown
                                             data-is-open="isOpen">
                                            <button type="button" class="no-style dropdown-toggle"
                                                    data-ng-disabled="vm.openDetail || vm.openMonitoring
                                                        || ComputeInfrastructureDiagramCtrl.model.currentLinkEdit !== null
                                                        || ComputeInfrastructureDiagramCtrl.volumeEdit.action === 'moveCheckbox'
                                                        || ComputeInfrastructureDiagramCtrl.loaders.volumeActionConfirm"
                                                    data-uib-dropdown-toggle
                                                    write-right-required>
                                                <i class="glyphicon glyphicon-menu-down"></i>
                                            </button>

                                            <ul class="dropdown-menu" role="menu"
                                                data-ng-if="vm.status === 'DRAFT'"
                                                data-uib-dropdown-menu>
                                                <li>
                                                    <button type="button" class="red"
                                                            data-ng-click="ComputeInfrastructureDiagramCtrl.deleteConfirmPending(vm)">
                                                        <span class="fa fa-trash-o right-space-m8" aria-hidden="true"></span>
                                                        <span data-ng-bind="'cpci_vm_action_delete' | translate"></span>
                                                    </button>
                                                </li>
                                            </ul>

                                            <ul class="dropdown-menu" role="menu"
                                                data-ng-if="vm.status !== 'DRAFT'"
                                                data-uib-dropdown-menu>
                                                <li>
                                                    <button type="button"
                                                            data-ng-click="ComputeInfrastructureDiagramCtrl.toggleVmEditionState(vm)">
                                                        <span class="fa fa-edit right-space-m8" aria-hidden="true"></span>
                                                        <span data-ng-bind="'cpci_vm_action_edit' | translate"></span>
                                                    </button>
                                                </li>
                                                <li>
                                                    <button type="button"
                                                            data-ng-click="ComputeInfrastructureDiagramCtrl.toggleVmEditionState(vm, 'NAME')">
                                                        <span class="fa fa-caret-right left-space-m8 right-space-m8" aria-hidden="true"></span>
                                                        <span data-ng-bind="'cpci_vm_action_edit_name' | translate"></span>
                                                    </button>
                                                </li>
                                                <li>
                                                    <button type="button"
                                                            data-ng-click="ComputeInfrastructureDiagramCtrl.toggleVmEditionState(vm, 'FLAVOR')">
                                                        <span class="fa fa-caret-right left-space-m8 right-space-m8" aria-hidden="true"></span>
                                                        <span data-ng-bind="'cpci_vm_action_edit_type' | translate"></span>
                                                    </button>
                                                </li>
                                                <li>
                                                    <button type="button"
                                                            data-ng-click="ComputeInfrastructureDiagramCtrl.toggleVmEditionState(vm, 'IMAGE')">
                                                        <span class="fa fa-caret-right left-space-m8 right-space-m8" aria-hidden="true"></span>
                                                        <span data-ng-bind="'cpci_vm_action_edit_restaure' | translate"></span>
                                                    </button>
                                                </li>
                                                <li>
                                                    <button type="button"
                                                            data-ng-click="ComputeInfrastructureDiagramCtrl.openVmMonitoringPanel(vm)">
                                                        <span class="fa fa-search right-space-m8" aria-hidden="true"></span>
                                                        <span data-ng-bind="'cpci_vm_action_monitoring' | translate"></span>
                                                    </button>
                                                </li>
                                                <li data-ng-if="!vm.monthlyBilling">
                                                    <button type="button"
                                                            data-ng-click="ComputeInfrastructureDiagramCtrl.InfrastructureService.openMonthlyConfirmation(vm)">
                                                        <span class="fa fa-calendar right-space-m8" aria-hidden="true"></span>
                                                        <span data-ng-bind="'cpci_vm_action_monthly' | translate"></span>
                                                    </button>
                                                </li>
                                                <li>
                                                    <button type="button"
                                                            data-ng-click="ComputeInfrastructureDiagramCtrl.InfrastructureService.openSnapshotWizard(vm)">
                                                        <span class="fa fa-floppy-o right-space-m8" aria-hidden="true"></span>
                                                        <span data-ng-bind="'cpci_vm_action_create_snapshot' | translate"></span>
                                                    </button>
                                                </li>
                                                <li class="divider"></li>
                                                <li>
                                                    <button type="button"
                                                            data-ng-click="ComputeInfrastructureDiagramCtrl.displayVmAuthInfo(vm)" >
                                                        <span class="fa fa-key right-space-m8" aria-hidden="true"></span>
                                                        <span data-ng-bind="'cpci_vm_action_auth_info' | translate"></span>
                                                    </button>
                                                </li>
                                                <li>
                                                    <button type="button"
                                                            data-ng-click="ComputeInfrastructureDiagramCtrl.InfrastructureService.openVnc(vm)" >
                                                        <span class="fa fa-desktop right-space-m8" aria-hidden="true"></span>
                                                        <span data-ng-bind="'cpci_vm_action_vnc' | translate"></span>
                                                    </button>
                                                </li>
                                                <li class="divider"></li>
                                                <li>
                                                    <button type="button" class="red"
                                                            data-ng-click="ComputeInfrastructureDiagramCtrl.InfrastructureService.rescueMode(vm)">
                                                        <span class="fa fa-power-off right-space-m8" aria-hidden="true"></span>
                                                        <span data-ng-bind="'cpci_vm_action_rescue' | translate"></span>
                                                    </button>
                                                </li>
                                                <li class="divider"></li>
                                                <li>
                                                    <button type="button" class="red"
                                                            data-ng-click="ComputeInfrastructureDiagramCtrl.InfrastructureService.rebootVirtualMachine(vm, 'soft')">
                                                        <span class="fa fa-power-off right-space-m8" aria-hidden="true"></span>
                                                        <span data-ng-bind="'cpci_vm_action_reboot' | translate"></span>
                                                    </button>
                                                </li>
                                                <li>
                                                    <button type="button" class="red"
                                                            data-ng-click="ComputeInfrastructureDiagramCtrl.InfrastructureService.rebootVirtualMachine(vm, 'hard')">
                                                        <span class="fa fa-power-off right-space-m8" aria-hidden="true"></span>
                                                        <span data-ng-bind="'cpci_vm_action_reboot_hard' | translate"></span>
                                                    </button>
                                                </li>
                                                <li class="divider"></li>
                                                <li>
                                                    <button type="button" class="red"
                                                            data-ng-click="ComputeInfrastructureDiagramCtrl.InfrastructureService.reinstallVirtualMachine(vm); vm.collapsed = false">
                                                        <span class="fa fa-refresh right-space-m8" aria-hidden="true"></span>
                                                        <span data-ng-bind="'cpci_vm_action_reinstall' | translate"></span>
                                                    </button>
                                                </li>
                                                <li>
                                                    <button type="button" class="red"
                                                            data-ng-click="ComputeInfrastructureDiagramCtrl.deleteConfirmPending(vm)">
                                                        <span class="fa fa-trash-o right-space-m8" aria-hidden="true"></span>
                                                        <span data-ng-bind="'cpci_vm_action_delete' | translate"></span>
                                                    </button>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="clearfix"
                                             data-popover-append-to-body="true"
                                             data-popover-class="cloud-popover cloud-vm-popover"
                                             data-popover-enable="(vm.status === 'DRAFT' || vm.status === 'ACTIVE')
                                                    && ComputeInfrastructureDiagramCtrl.model.currentLinkEdit === null
                                                    && ComputeInfrastructureDiagramCtrl.volumeEdit.action !== 'moveCheckbox'"
                                             data-popover-is-open="vm.openDetail"
                                             data-popover-placement="right"
                                             data-popover-trigger="none"
                                             data-responsive-popover="'app/cloud/project/compute/infrastructure/virtualMachine/addEdit/cloud-project-compute-infrastructure-virtualMachine-addEdit.html'">
                                            <div class="has-monitoring-popover"
                                                 data-ng-click="ComputeInfrastructureDiagramCtrl.model.currentLinkEdit === null
                                                    && ComputeInfrastructureDiagramCtrl.volumeEdit.action !== 'moveCheckbox'
                                                    && ComputeInfrastructureDiagramCtrl.toggleVmEditionState(vm)"
                                                 data-popover-append-to-body="true"
                                                 data-popover-class="cloud-popover cloud-vm-popover vm-monitoring-popover"
                                                 data-popover-is-open="vm.openMonitoring"
                                                 data-popover-placement="auto right"
                                                 data-popover-trigger="none"
                                                 data-responsive-popover="'app/cloud/project/compute/infrastructure/virtualMachine/monitoring/cloud-project-compute-infrastructure-virtualMachine-monitoring.html'">

                                                <h3 class="text-center word-wrap">
                                                    <span class="ovh-font ovh-font-warning ovh-font-1x4"
                                                          data-ng-click="ComputeInfrastructureDiagramCtrl.openVmMonitoringPanel(vm)"
                                                          data-ng-if="(vm.monitoringData.cpu.needUpgrade || vm.monitoringData.cpu.needUpgrade) && vm.collapsed"
                                                          data-popover-trigger="mouseenter"
                                                          data-popover-template="'app/cloud/project/compute/infrastructure/popover/cloud-project-compute-infrastructure-cpu-ram.popover.html'">
                                                    </span>
                                                    <span data-ng-bind="vm.name"
                                                          data-ng-if="vm.name"></span>
                                                    <span data-ovh-stop-event="click">
                                                        <span class="ovh-font ovh-font-question right-space-m4"
                                                              data-uib-tooltip-html="'cpci_vm_nova_id' | translate:{id: vm.id}"
                                                              data-tooltip-trigger="click outsideClick">
                                                        </span>
                                                    </span>
                                                    <span class="vm-region-id"
                                                          data-ng-bind="vm.region"
                                                          data-ng-if="vm.collapsed && vm.region"></span>
                                                    <span class="text-danger"
                                                          data-ng-if="vm.status === 'DRAFT'">(draft)</span>
                                                </h3>

                                                <span class="vm-region"
                                                      data-ng-bind="ComputeInfrastructureDiagramCtrl.getTranslatedRegion(vm.region)"
                                                      data-ng-if="!vm.collapsed">
                                                </span>

                                                <div class="vm-network"
                                                     data-ng-if="vm.status !== 'DRAFT'">
                                                    <div class="vm-connection-management"
                                                         data-ovh-stop-event="click">
                                                        <div class="vm-port" id="{{ vm.id }}"
                                                             data-jsplumb-endpoint
                                                             data-jsplumb-endpoint-source-options="ComputeInfrastructureDiagramCtrl.vmSourceDrawOptions"
                                                             data-jsplumb-endpoint-target-options="ComputeInfrastructureDiagramCtrl.vmTargetDrawOptions"
                                                             data-jsplumb-endpoint-enabled="{{ vm.status === 'ACTIVE' && !vm.openDetail && ComputeInfrastructureDiagramCtrl.volumeEdit.action !== 'moveCheckbox' && !ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.isManual }}"
                                                             data-jsplumb-endpoint-connection-ids="{{ vm.routedTo }}">
                                                            <div class="port-inner"
                                                                 write-right-required></div>
                                                        </div>

                                                        <flat-checkbox data-ng-if="
                                                            vm.status === 'ACTIVE' && (
                                                                (ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.isManual
                                                                 && ComputeInfrastructureDiagramCtrl.getVmContinent(vm) === ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.connectedIp.continentCode)
                                                                || (ComputeInfrastructureDiagramCtrl.volumeEdit.action === 'moveCheckbox'
                                                                    && ComputeInfrastructureDiagramCtrl.volumeEdit.srcVm.id != vm.id
                                                                    && ComputeInfrastructureDiagramCtrl.volumeEdit.volume.region === vm.region)
                                                            )">
                                                            <input type="radio" id="vm-connection-check-{{ vm.id }}" name="myInputName"
                                                                   data-ng-change="ComputeInfrastructureDiagramCtrl.ipEdit.attach.changeRadioConnection(vm)"
                                                                   data-ng-disabled="ComputeInfrastructureDiagramCtrl.loaders.linkActionConfirm"
                                                                   data-ng-model="ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.connectionVmId"
                                                                   data-ng-if="ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.isManual"
                                                                   data-ng-value="vm.id"/>

                                                            <input type="radio" id="vm-connection-check-{{ vm.id }}" name="myInputName"
                                                                   data-ng-disabled="ComputeInfrastructureDiagramCtrl.loaders.volumeActionConfirm"
                                                                   data-ng-if="ComputeInfrastructureDiagramCtrl.volumeEdit.action === 'moveCheckbox'"
                                                                   data-ng-model="ComputeInfrastructureDiagramCtrl.volumeEdit.targetVm"
                                                                   data-ng-value="vm"/>
                                                        </flat-checkbox>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- footer -->
                                            <div class="vm-footer">
                                                <div class="vm-private-ip"
                                                     data-ng-if="ComputeInfrastructureDiagramCtrl.hasPrivateIp(vm) && !vm.collapsed"
                                                     data-translate="cpci_vm_private_ip_list" data-translate-values="{privateAddresses: ComputeInfrastructureDiagramCtrl.getVirtualMachinePrivateAddresses(vm).join(', ')}">
                                                </div>
                                                <div class="vm-hardware-detail hidden-collapsed clearfix has-monitoring-popover">
                                                    <div class="vm-stat stat-core col-xs-4 text-center no-space"
                                                         data-ng-click="ComputeInfrastructureDiagramCtrl.openVmMonitoringPanel(vm)"
                                                         data-ng-if="vm.monitoringData.cpu.needUpgrade"
                                                         data-popover-popup-delay="1"
                                                         data-popover-template="'app/cloud/project/compute/infrastructure/popover/cloud-project-compute-infrastructure-cpu.popover.html'"
                                                         data-popover-trigger="mouseenter">
                                                        <span class="ovh-font ovh-font-warning fs14 right-space-m4" aria-hidden="true"></span>
                                                        <span data-translate="cpci_vm_vcpus_number"
                                                              data-translate-values="{ vcpus : vm.flavor.vcpus || '?' }">
                                                        </span>
                                                    </div>
                                                    <div class="vm-stat stat-core col-xs-4 text-center"
                                                         data-ng-if="!vm.monitoringData.cpu.needUpgrade">
                                                        <span data-translate="cpci_vm_vcpus_number"
                                                              data-translate-values="{ vcpus : vm.flavor.vcpus || '?' }">
                                                        </span>
                                                    </div>

                                                    <div class="vm-stat stat-ram col-xs-4 text-center no-space"
                                                         data-ng-click="ComputeInfrastructureDiagramCtrl.openVmMonitoringPanel(vm)"
                                                         data-ng-if="vm.monitoringData.mem.needUpgrade"
                                                         data-popover-popup-delay="1"
                                                         data-popover-template="'app/cloud/project/compute/infrastructure/popover/cloud-project-compute-infrastructure-ram.popover.html'"
                                                         data-popover-trigger="mouseenter">
                                                        <span class="ovh-font ovh-font-warning fs14 right-space-m4" aria-hidden="true"></span>
                                                        <span data-translate="cpci_vm_ram_amount"
                                                              data-translate-values="{ ram : (vm.flavor.ram * ComputeInfrastructureDiagramCtrl.conversion.MEGABYTE_TO_BYTE | bytes) }">
                                                        </span>
                                                    </div>
                                                    <div class="vm-stat stat-ram col-xs-4 text-center"
                                                         data-ng-if="!vm.monitoringData.mem.needUpgrade">
                                                        <span data-translate="cpci_vm_ram_amount"
                                                              data-translate-values="{ ram : (vm.flavor.ram * ComputeInfrastructureDiagramCtrl.conversion.MEGABYTE_TO_BYTE | bytes) }">
                                                        </span>
                                                    </div>
                                                    <div class="vm-stat stat-disk col-xs-4 text-center"
                                                         data-translate="cpci_vm_disk_amount"
                                                         data-translate-values="{ disk : (vm.flavor.disk | bytes:2:true:'GiB') }">
                                                    </div>
                                                </div>

                                                <div class="volume-content-linked"
                                                     data-ng-class="{
                                                        hasCurrentDroppableVolume : ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDraggedVolume.draggableInfo.volume.region === vm.region && vm.getStatusGroup() === 'ACTIVE',
                                                        opacity5 : ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDraggedVolume && ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDraggedVolume.draggableInfo.volume.region !== vm.region
                                                    }">

                                                    <div class="volume-detail clearfix"
                                                         data-ng-show="(vm.collapsedVolumes && !vm.collapsed)
                                                            || (vm.collapsedVolumes && vm.collapsed && ComputeInfrastructureDiagramCtrl.volumes[vm.id].length)
                                                            || ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDroppableVmId === vm.id">
                                                        <ul class="volume-content-linked-items clearfix volume-content-linked-items-{{vm.id}}">

                                                            <li class="volume-detail-item volume-detail-item-{{vm.region}} cuc-highlighted-element"
                                                                data-ng-class="{'visibility-hide' : !ComputeInfrastructureDiagramCtrl.dragDropHelper.draggingIsDoing && ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDraggedVolume.draggableInfo.volume.id === volume.id}"
                                                                data-ng-repeat="volume in ComputeInfrastructureDiagramCtrl.volumes[vm.id]"
                                                                data-draggable
                                                                data-draggable-disabled="{{volume.getStatusGroup() !== 'ACTIVE'
                                                                    || ComputeInfrastructureDiagramCtrl.volumeEdit.action === 'moveCheckbox'
                                                                    || ComputeInfrastructureDiagramCtrl.model.currentLinkEdit !== null
                                                                    || volume.openDetail
                                                                    || vm.openDetail}}"
                                                                data-draggable-id="{{volume.id}}"
                                                                data-draggable-info="{'volume':{{volume}}, 'srcVmId':'{{vm.id}}'}"
                                                                data-draggable-options="{{ComputeInfrastructureDiagramCtrl.draggableOptions.linked}}"
                                                                data-draggable-src-cloned-class="volume-detail-item-helper"
                                                                data-cuc-highlighted-element="{{volume.id}}"
                                                                data-uib-tooltip="{{ volume.name + ' (' + volume.region + ')' }}">

                                                                <button type="button" class="btn volume-detail-item-illustration"
                                                                        data-ng-click="
                                                                            ComputeInfrastructureDiagramCtrl.model.currentLinkEdit === null
                                                                            && ComputeInfrastructureDiagramCtrl.volumeEdit.action !== 'moveCheckbox'
                                                                            && (volume.getStatusGroup() === 'ACTIVE' || volume.getStatusGroup() === 'DRAFT')
                                                                            && !vm.openDetail
                                                                            && ComputeInfrastructureDiagramCtrl.toggleVolumeEditionState(volume)"
                                                                        data-popover-append-to-body="true"
                                                                        data-popover-class="cloud-popover cloud-vm-popover-volume"
                                                                        data-popover-enable="
                                                                            ComputeInfrastructureDiagramCtrl.model.currentLinkEdit === null
                                                                            && ComputeInfrastructureDiagramCtrl.volumeEdit.action !== 'moveCheckbox'
                                                                            && (volume.getStatusGroup() === 'ACTIVE' || volume.getStatusGroup() === 'DRAFT')
                                                                            && !vm.openDetail"
                                                                        data-popover-is-open="volume.openDetail"
                                                                        data-popover-placement="right"
                                                                        data-popover-trigger="none"
                                                                        data-responsive-popover="'app/cloud/project/compute/infrastructure/volume/addEdit/cloud-project-compute-infrastructure-volume-addEdit.html'">
                                                                    <span data-ng-class="{'opacity2' : volume.getStatusGroup() !== 'ACTIVE'}">
                                                                        <span data-ng-if="volume.type==='high-speed'">
                                                                            <span class="ovh-font ovh-font-harddiskspeed"></span>
                                                                        </span>
                                                                        <span data-ng-if="volume.type==='classic'">
                                                                            <span class="ovh-font ovh-font-harddisk"></span>
                                                                        </span>
                                                                    </span>
                                                                    <span class="d-block text-center"
                                                                          data-ng-if="volume.getStatusGroup() !== 'ACTIVE' && volume.getStatusGroup() !== 'DRAFT'">
                                                                        <oui-spinner size="s" inline="true"></oui-spinner>
                                                                    </span>
                                                                </button>

                                                                <div class="volume-detail-item-info">
                                                                    <div class="btn-group"
                                                                         data-uib-dropdown
                                                                         data-is-open="isopen">
                                                                        <button type="button" class="no-style no-space"
                                                                                data-ng-disabled="ComputeInfrastructureDiagramCtrl.model.currentLinkEdit !== null
                                                                                    || ComputeInfrastructureDiagramCtrl.volumeEdit.action === 'moveCheckbox'
                                                                                    || (volume.getStatusGroup() !== 'ACTIVE' && volume.getStatusGroup() !== 'DRAFT')
                                                                                    || (ComputeInfrastructureDiagramCtrl.volumeEdit && ComputeInfrastructureDiagramCtrl.volumeEdit.action === 'remove')
                                                                                    || vm.openDetail
                                                                                    || vm.openMonitoring
                                                                                    || volume.openDetail"
                                                                                data-uib-dropdown-toggle>
                                                                            <span class="ovh-font ovh-font-bootDisk" title="{{:: 'common_disk_bootable' | translate}}"
                                                                                  data-ng-if="volume.bootable"></span>
                                                                            <span data-ng-bind="volume.size | bytes:2:true:'GiB'"></span>
                                                                            <i class="glyphicon glyphicon-menu-down"
                                                                               write-right-required></i>
                                                                        </button>
                                                                        <ul class="dropdown-menu" role="menu"
                                                                            data-uib-dropdown-menu
                                                                            write-right-required>
                                                                            <li>
                                                                                <button type="button"
                                                                                        data-ng-click="ComputeInfrastructureDiagramCtrl.volumeEdit.moveCheckbox.launchConfirm(volume, vm)">
                                                                                    <span class="fa fa-exchange right-space-m8" aria-hidden="true"></span>
                                                                                    <span data-ng-bind="'cpci_volume_move' | translate"></span>
                                                                                </button>
                                                                            </li>
                                                                            <li>
                                                                                <button type="button"
                                                                                        data-ng-click="ComputeInfrastructureDiagramCtrl.volumeEdit.move.launchConfirm(volume, vm)">
                                                                                    <span class="fa fa-chain-broken right-space-m8" aria-hidden="true"></span>
                                                                                    <span data-ng-bind="'cpci_volume_detach' | translate"></span>
                                                                                </button>
                                                                            </li>
                                                                            <li class="divider"></li>
                                                                            <li>
                                                                                <button type="button"
                                                                                        data-ng-click="ComputeInfrastructureDiagramCtrl.model.currentLinkEdit === null && ComputeInfrastructureDiagramCtrl.toggleVolumeEditionState(volume)">
                                                                                    <span class="fa fa-edit right-space-m8" aria-hidden="true"></span>
                                                                                    <span data-ng-bind="'cpci_vm_action_edit' | translate"></span>
                                                                                </button>
                                                                            </li>
                                                                            <li>
                                                                                <button type="button"
                                                                                        data-ng-click="ComputeInfrastructureDiagramCtrl.model.currentLinkEdit === null && ComputeInfrastructureDiagramCtrl.toggleVolumeEditionState(volume, 'NAME')">
                                                                                    <span class="fa fa-caret-right right-space-m8 left-space-m8" aria-hidden="true"></span>
                                                                                    <span data-ng-bind="'cpci_vm_action_edit_name' | translate"></span>
                                                                                </button>
                                                                            </li>
                                                                            <li>
                                                                                <button type="button"
                                                                                        data-ng-click="ComputeInfrastructureDiagramCtrl.model.currentLinkEdit === null && ComputeInfrastructureDiagramCtrl.toggleVolumeEditionState(volume, 'SIZE')">
                                                                                    <span class="fa fa-caret-right right-space-m8 left-space-m8" aria-hidden="true"></span>
                                                                                    <span data-ng-bind="'cpci_vm_action_edit_size' | translate"></span>
                                                                                </button>
                                                                            </li>
                                                                            <li>
                                                                                <button type="button"
                                                                                        data-ng-click="ComputeInfrastructureDiagramCtrl.openVolumeSnapshotWizard(volume)">
                                                                                    <span class="fa fa-floppy-o right-space-m8" aria-hidden="true"></span>
                                                                                    <span data-ng-bind="'cpci_volume_action_backup' | translate"></span>
                                                                                </button>
                                                                            </li>
                                                                            <li class="divider"></li>
                                                                            <li>
                                                                                <button type="button" class="red"
                                                                                        data-ng-click="ComputeInfrastructureDiagramCtrl.volumeEdit.remove.launchConfirm(volume)">
                                                                                    <span class="fa fa-trash-o right-space-m8" aria-hidden="true"></span>
                                                                                    <span data-ng-bind="'cpci_volume_delete' | translate"></span>
                                                                                </button>
                                                                            </li>
                                                                        </ul>
                                                                    </div>
                                                                </div>
                                                            </li>

                                                            <li class="volume-detail-item opacity4"
                                                                data-ng-show="ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDroppableVmId === vm.id
                                                                    && ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDraggedVolume.draggableInfo.srcVmId !== vm.id">
                                                                <div>
                                                                    <div data-ng-if="ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDraggedVolume.draggableInfo.volume.type==='high-speed'">
                                                                        <span class="ovh-font ovh-font-harddiskspeed"></span>
                                                                    </div>
                                                                    <div data-ng-if="ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDraggedVolume.draggableInfo.volume.type==='classic'" style="padding-top:5px;">
                                                                        <span class="ovh-font ovh-font-harddisk"></span>
                                                                    </div>
                                                                </div>

                                                                <div class="volume-detail-item-info">
                                                                    <span data-ng-bind="ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDraggedVolume.draggableInfo.volume.size | bytes:2:true:'GiB'"></span>
                                                                </div>
                                                            </li>
                                                        </ul>
                                                    </div>

                                                    <div class="volume-resume"
                                                         data-ng-show="!vm.collapsed
                                                            || (vm.collapsed && ComputeInfrastructureDiagramCtrl.volumes[vm.id].length)
                                                            || ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDroppableVmId === vm.id"
                                                         data-ng-style="(vm.collapsedVolumes || ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDroppableVmId === vm.id) && {'border-top' : 'none'}">
                                                        <button type="button" class="vm-collapse-button no-style"
                                                                data-ng-click="ComputeInfrastructureDiagramCtrl.toggleCollapsedVolumes(vm)">
                                                            <span data-ng-hide="ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDraggedVolume && ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDraggedVolume.draggableInfo.volume.region !== vm.region">
                                                                <span class="fa fa-caret-right rotate right-space-m8" aria-hidden="true"
                                                                      data-ng-class="{ 'rotate-90': vm.collapsedVolumes || ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDroppableVmId === vm.id }"></span>
                                                                <span translate="cpci_volume_number_attach_zero"
                                                                      data-ng-if="!ComputeInfrastructureDiagramCtrl.volumes[vm.id].length"></span>
                                                                <span translate="cpci_volume_number_attach_one"
                                                                      data-ng-if="ComputeInfrastructureDiagramCtrl.volumes[vm.id].length === 1"></span>
                                                                <span translate="cpci_volume_number_attach_other"
                                                                      data-translate-values="{nbVolume: ComputeInfrastructureDiagramCtrl.volumes[vm.id].length}"
                                                                      data-ng-if="ComputeInfrastructureDiagramCtrl.volumes[vm.id].length > 1"></span>
                                                            </span>
                                                            <span translate="cpci_volume_impossible_attach"
                                                                  data-ng-show="ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDraggedVolume && ComputeInfrastructureDiagramCtrl.dragDropHelper.currentDraggedVolume.draggableInfo.volume.region !== vm.region"></span>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- IPs -->
            <div class="col-xs-4">

                <div id="infra-ips-ctnr">

                    <div class="header">
                        <h1>{{ 'cpci_public_network'|translate }} <small>- {{ 'cpci_internet'|translate }}</small></h1>
                        <div class="public-network-hline-title"></div>
                    </div>

                    <div class="infra-ips-list-ctnr">

                        <div class="ipautosort clearfix"
                             data-ng-if="ComputeInfrastructureDiagramCtrl.infra.vrack.publicCloud.sortedKeys.length > 0">
                            <button class="pull-right no-style"
                                    data-ng-click="ComputeInfrastructureDiagramCtrl.toggleIpSort()"
                                    data-ng-disabled="ComputeInfrastructureDiagramCtrl.sort.ipAutoSort">
                                <span data-ng-bind="'cloud_ip_action_automatic' | translate"></span>
                            </button>
                            <flat-switch class="pull-right">
                                <input id="autoSortInput" type="checkbox"
                                       data-ng-checked="ComputeInfrastructureDiagramCtrl.sort.ipAutoSort"
                                       data-ng-click="ComputeInfrastructureDiagramCtrl.toggleIpSort()">
                            </flat-switch>
                            <button class="pull-right no-style"
                                    data-ng-click="ComputeInfrastructureDiagramCtrl.toggleIpSort()"
                                    data-ng-disabled="!ComputeInfrastructureDiagramCtrl.sort.ipAutoSort">
                                <span data-ng-bind="'cloud_ip_action_manual' | translate"></span>
                            </button>
                            <label for="autoSortInput" class="pull-right">
                                <span data-ng-bind="'cloud_ip_action_sort' | translate"></span> :
                            </label>
                        </div>

                        <!-- IPFO Import pending... -->
                        <div class="ip ip-failover ip-failover-import no-select fade-transition"
                             data-instance-id="{{:: ip.routedTo }}"
                             data-ng-mouseenter="ComputeInfrastructureDiagramCtrl.highlightInstanceAndPublicIP($event)"
                             data-ng-mouseleave="ComputeInfrastructureDiagramCtrl.removeAllFades()"
                             data-ng-show="ComputeInfrastructureDiagramCtrl.importedIpFailoverPending.length > 0">

                            <div class="ip-content clearfix animate-fadeIn-enter animate-fadeOut-leave"
                                 data-ng-if="ComputeInfrastructureDiagramCtrl.importedIpFailoverPending.length">

                                <div class="pull-left text-right left-space-m16">
                                    <span data-ng-bind="ComputeInfrastructureDiagramCtrl.importedIpFailoverPending.length"></span>x
                                    <span data-ng-bind="'cloud_public_ip_failover' | translate"></span>
                                </div>

                                <!-- IP infos -->
                                <span class="ip-text"
                                      data-ng-bind=":: 'cpci_ipfo_importing' | translate">
                                </span>
                                <span class="pull-right right-space-m8">
                                    <oui-spinner size="s" inline="true"></oui-spinner>
                                </span>
                            </div>
                        </div>

                        <!-- IPS: list of IPs (sortable) -->
                        <div class="ip-block"
                             data-ng-if="!ComputeInfrastructureDiagramCtrl.loaders.ips"
                             data-ng-model="ComputeInfrastructureDiagramCtrl.infra.internet.ipList.sortedKeys"
                             data-ui-sortable="ComputeInfrastructureDiagramCtrl.ipSortableOptions">

                            <!-- IP LIST -->
                            <div data-ng-repeat="ip in ComputeInfrastructureDiagramCtrl.infra.internet.ipList.getItems() | orderBy:[ComputeInfrastructureDiagramCtrl.ipAutoSort(), ComputeInfrastructureDiagramCtrl.ipSortNatural()] track by ip.id">
                                <div class="ip cuc-highlighted-element ip-{{::ip.type}} fade-transition"
                                     data-ng-class="{'sortable-disabled': !!ComputeInfrastructureDiagramCtrl.model.currentLinkEdit || ComputeInfrastructureDiagramCtrl.sort.ipAutoSort}"
                                     data-cuc-highlighted-element="ip,{{ip.id}},ip-{{::ip.type}},ip-{{::ip.type}}-{{::ip.status}}-{{::ip.continentCode}}"
                                     data-instance-id="{{:: ip.routedTo }}"
                                     data-ng-mouseenter="ComputeInfrastructureDiagramCtrl.highlightInstanceAndPublicIP($event)"
                                     data-ng-mouseleave="ComputeInfrastructureDiagramCtrl.removeAllFades()">
                                    <!-- IP content -->
                                    <div class="ip-content clearfix">

                                        <div class="ip-grip no-select"
                                             data-ng-if="!ComputeInfrastructureDiagramCtrl.sort.ipAutoSort">
                                            <span class="ovh-font ovh-font-grip vertical-middle opacity5"></span>
                                        </div>

                                        <!-- dropdown ip actions -->
                                        <ip-dropdown
                                            data-ip="ip" data-user="ComputeInfrastructureDiagramCtrl.user"
                                            data-infra="ComputeInfrastructureDiagramCtrl.infra"
                                            data-on-failover-attach="ComputeInfrastructureDiagramCtrl.ipEdit.attach.button(ip)"
                                            data-is-disabled="ComputeInfrastructureDiagramCtrl.model.currentLinkEdit !== null || ComputeInfrastructureDiagramCtrl.volumeEdit.action === 'moveCheckbox'"
                                            ip-access-key="'ip'">
                                        </ip-dropdown>
                                        <span class="ip-spinner text-center"
                                              data-ng-if="ip.status !== 'ok'">
                                            <oui-spinner data-ng-if="ip.type === 'failover'" size="s" inline="true"></oui-spinner>
                                            <oui-spinner data-ng-if="ip.type !== 'failover'" size="s" inline="true"></oui-spinner>
                                        </span>

                                        <!-- flag -->
                                        <span class="label ip-geoloc pull-left fs11"
                                              data-ng-if="ip.type === 'failover'">
                                            <span class="right-space-m4">
                                                <span data-ng-bind=":: 'cloud_public_ip_failover' | translate"></span>
                                                <span data-ng-bind="ip.subType"></span>
                                            </span>
                                            <span data-ng-bind="ip.geoloc"
                                                  data-ng-if="ip.geoloc"></span>
                                        </span>

                                        <!-- IP infos -->
                                        <span class="ip-text"
                                              data-ng-if="ip.ip">
                                            <span class="fa fa-info-circle right-space-m4"
                                                  data-ng-if="ip.reverse"
                                                  data-uib-tooltip="{{ ComputeInfrastructureDiagramCtrl.ipReverse(ip) }}"></span>
                                            <span data-ng-bind="ip.ip"></span>
                                        </span>

                                        <div class="public-network-hline-ip"></div>
                                    </div>

                                    <div class="ip-connection-management">
                                        <div class="ip-port" id="{{ ip.id }}"
                                             data-jsplumb-endpoint
                                             data-jsplumb-endpoint-connection-ids="{{ ip.routedTo }}"
                                             data-jsplumb-endpoint-enabled="{{ ip.type !== 'public' && ip.status === 'ok' }}"
                                             data-jsplumb-endpoint-source-options="ComputeInfrastructureDiagramCtrl.ipSourceDrawOptions"
                                             data-jsplumb-endpoint-target-options="ComputeInfrastructureDiagramCtrl.ipTargetDrawOptions">
                                            <div class="port-inner"
                                                 data-ng-class="{ pointer : ip.status === 'ok' }"
                                                 data-ng-hide="ip.type === 'public'"
                                                 write-right-required>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="ip ipV6 cuc-highlighted-element fade-transition"
                                     data-ng-if="ip.ipV6"
                                     data-instance-id="{{:: ip.routedTo }}"
                                     data-cuc-highlighted-element="ip,{{ip.id}},ip-{{::ip.type}},ip-{{::ip.type}}-{{::ip.status}}-{{::ip.continentCode}}">
                                    <div class="ip-content clearfix">
                                        <span class="ip-text"
                                              data-ng-if="ip.ip">
                                            <span class="fa fa-info-circle right-space-m4"
                                                  data-ng-if="ip.reverse"
                                                  data-uib-tooltip="{{ ComputeInfrastructureDiagramCtrl.ipReverse(ip) }}"></span>
                                            <span data-ng-bind="ip.ipV6.ip"></span>
                                            <span class="ovh-font ovh-font-question right-space-m4"
                                                  data-uib-tooltip="{{:: 'cloud_public_ip_v6_gateway' | translate:{ gateway: ip.ipV6.gateway } }}"
                                                  data-tooltip-placement="left"
                                                  data-tooltip-trigger="click outsideClick">
                                            </span>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div class="public-network-vline-right"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="clearfix"
         data-ng-include="'app/cloud/project/compute/infrastructure/openstackClient/cloud-project-compute-infrastructure-openstack-client.html'"
         data-ng-if="ComputeInfrastructureDiagramCtrl.openstackClientOpen">
    </div>
    <div class="bottom-validator animate-fadeInUp-enter animate-fadeOutDown-leave"
         data-ng-if="ComputeInfrastructureDiagramCtrl.model.currentLinkEdit">

        <div class="text-center"
             data-ng-if="ComputeInfrastructureDiagramCtrl.loaders.linkActionConfirm">
            <oui-spinner size="m" inline="true"></oui-spinner>
        </div>

        <div class="row"
             data-ng-if="!ComputeInfrastructureDiagramCtrl.loaders.linkActionConfirm">

            <p class="validator-text"
               data-ng-if="ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.connection && ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.connectedIp.routedTo.length > 0"
               data-translate="cpci_confirm_attach_question"
               data-translate-values="{ ip : ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.connectedIp.ip, futurInstanceAttach : ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.connectedVm.name, currentInstanceAttach : ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.connectedVmCurrent.name }">
            </p>

            <p class="validator-text"
               data-ng-if="ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.connection && ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.connectedIp.routedTo.length === 0"
               data-translate="cpci_confirm_floating_attach_question"
               data-translate-values="{ ip : ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.connectedIp.ip, futurInstanceAttach : ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.connectedVm.name}">
            </p>

            <p class="validator-text"
               data-ng-if="!ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.connection"
               data-translate="cpci_ipfo_attach_question"
               data-translate-values="{ ip : ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.connectedIp.ip }">
            </p>

            <p class="validator-text"
               data-ng-if="ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.action === 'detach'"
               data-translate="{{'cpci_confirm_detach_question'}}"
               data-translate-values="{ ip : ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.connectedIp.ip, instance : ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.connectedVm.name }">
            </p>

            <div class="col-md-4 col-md-offset-2">
                <button type="button" class="btn btn-lg btn-action btn-default bottom-space-m4"
                        data-ng-bind="'common_cancel' | translate"
                        data-ng-click="ComputeInfrastructureDiagramCtrl.ipEdit[ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.action].cancel()"
                        data-ng-disabled="ComputeInfrastructureDiagramCtrl.loaders.linkActionConfirm">
                </button>
            </div>
            <div class="col-md-4">
                <button type="button" class="btn btn-lg btn-action btn-primary"
                        data-ng-bind="'cpci_confirm_' + ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.action + '_button' | translate"
                        data-ng-click="ComputeInfrastructureDiagramCtrl.ipEdit[ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.action].confirm()"
                        data-ng-disabled="ComputeInfrastructureDiagramCtrl.loaders.linkActionConfirm
                            || (ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.isManual
                            && (ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.connectionCurrentVmId === ComputeInfrastructureDiagramCtrl.model.currentLinkEdit.connectionVmId))">
                </button>
            </div>
        </div>
    </div>

    <div class="bottom-validator animate-fadeInUp-enter animate-fadeOutDown-leave"
         data-ng-if="ComputeInfrastructureDiagramCtrl.volumeEdit.action">

        <div class="text-center"
             data-ng-if="ComputeInfrastructureDiagramCtrl.loaders.volumeActionConfirm">
            <oui-spinner size="s" inline="true"></oui-spinner>
        </div>

        <div class="row"
             data-ng-if="!ComputeInfrastructureDiagramCtrl.loaders.volumeActionConfirm">

            <p class="validator-text"
               data-ng-if="ComputeInfrastructureDiagramCtrl.volumeEdit.action === 'move' && !ComputeInfrastructureDiagramCtrl.volumeEdit.targetVm"
               data-translate="{{'cpci_volume_confirm_detach_question'}}"
               data-translate-values="{
                    volume : ComputeInfrastructureDiagramCtrl.volumeEdit.volume.name,
                    srcVm  : ComputeInfrastructureDiagramCtrl.volumeEdit.srcVm.name
                }">
            </p>

            <p class="validator-text"
               data-ng-if="ComputeInfrastructureDiagramCtrl.volumeEdit.action === 'move' && ComputeInfrastructureDiagramCtrl.volumeEdit.targetVm"
               data-translate="{{'cpci_volume_confirm_move_question'}}"
               data-translate-values="{
                    volume   : ComputeInfrastructureDiagramCtrl.volumeEdit.volume.name,
                    srcVm    : ComputeInfrastructureDiagramCtrl.volumeEdit.srcVm.name,
                    targetVm : ComputeInfrastructureDiagramCtrl.volumeEdit.targetVm.name
                }">
            </p>

            <p class="validator-text"
               data-ng-if="ComputeInfrastructureDiagramCtrl.volumeEdit.action === 'remove'"
               data-translate="{{'cpci_volume_confirm_remove_question'}}"
               data-translate-values="{
                    volume   : ComputeInfrastructureDiagramCtrl.volumeEdit.volume.name
                }">
            </p>

            <p class="validator-text"
               data-ng-if="ComputeInfrastructureDiagramCtrl.volumeEdit.action === 'moveCheckbox'">
                <span data-ng-show="ComputeInfrastructureDiagramCtrl.volumeEdit[ComputeInfrastructureDiagramCtrl.volumeEdit.action].isInvalid()"
                      data-translate="{{'cpci_volume_moveCheckbox_question_invalid'}}"
                      data-translate-values="{
                        volume   : ComputeInfrastructureDiagramCtrl.volumeEdit.volume.name
                    }"></span>
                <span data-ng-show="!ComputeInfrastructureDiagramCtrl.volumeEdit[ComputeInfrastructureDiagramCtrl.volumeEdit.action].isInvalid() && ComputeInfrastructureDiagramCtrl.volumeEdit.srcVm"
                      data-translate="{{'cpci_volume_confirm_move_question'}}"
                      data-translate-values="{
                        volume   : ComputeInfrastructureDiagramCtrl.volumeEdit.volume.name,
                        srcVm    : ComputeInfrastructureDiagramCtrl.volumeEdit.srcVm.name,
                        targetVm : ComputeInfrastructureDiagramCtrl.volumeEdit.targetVm.name
                    }"></span>
                <span data-ng-show="!ComputeInfrastructureDiagramCtrl.volumeEdit[ComputeInfrastructureDiagramCtrl.volumeEdit.action].isInvalid() && !ComputeInfrastructureDiagramCtrl.volumeEdit.srcVm"
                      data-translate="{{'cpci_volume_moveCheckbox_question_valid'}}"
                      data-translate-values="{
                        volume   : ComputeInfrastructureDiagramCtrl.volumeEdit.volume.name,
                        targetVm : ComputeInfrastructureDiagramCtrl.volumeEdit.targetVm.name
                    }"></span>
            </p>

            <div class="col-md-4 col-md-offset-2">
                <button type="button" class="btn btn-lg btn-action btn-default bottom-space-m4"
                        data-ng-bind="'common_cancel' | translate"
                        data-ng-click="ComputeInfrastructureDiagramCtrl.volumeEdit[ComputeInfrastructureDiagramCtrl.volumeEdit.action].cancel()"
                        data-ng-disabled="ComputeInfrastructureDiagramCtrl.loaders.volumeActionConfirm">
                </button>
            </div>
            <div class="col-md-4">
                <button type="button" class="btn btn-lg btn-action btn-primary"
                        data-ng-bind="'cpci_volume_confirm_' + ComputeInfrastructureDiagramCtrl.volumeEdit.action + '_button' | translate"
                        data-ng-click="ComputeInfrastructureDiagramCtrl.volumeEdit[ComputeInfrastructureDiagramCtrl.volumeEdit.action].confirm(); ComputeInfrastructureDiagramCtrl.refreshLinks()"
                        data-ng-disabled="ComputeInfrastructureDiagramCtrl.loaders.volumeActionConfirm || ComputeInfrastructureDiagramCtrl.volumeEdit[ComputeInfrastructureDiagramCtrl.volumeEdit.action].isInvalid()">
                </button>
            </div>
        </div>
    </div>
    <div data-ui-view="cloudProjectInfrastructureModal"></div>
</div>
