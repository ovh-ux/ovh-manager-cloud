<div data-ng-controller="CloudProjectComputeInfrastructureVirtualMachineAddEditCtrl as VmAddEditCtrl" write-right-required>

    <!--
        responsive-switch
        responsive-switch-sidebyside
        responsive-switch-switch
        responsive-switch-expand
    -->
    <div data-responsive-switch
         data-responsive-switch-match-media="(max-width: 800px)"
         data-cuc-smooth-scroll-here="{ delay: 500, offset: -100 }"
         data-responsive-switch-pages-width="450"
         data-responsive-switch-active-page-index="{{ VmAddEditCtrl.activeSwitchPageIndex }}">

        <!--
            responsive-switch-page
            page-on-foreground
         -->
        <div data-responsive-switch-page class="responsive-switch-page-left">
            <div class="header">
                <h2 data-ng-if="!VmAddEditCtrl.vmInEdition.saveForEdition" class="text-center" translate="cpcivm_addedit_add_title"></h2>
                <h2 data-ng-if="!!VmAddEditCtrl.vmInEdition.saveForEdition" class="text-center" translate="cpcivm_addedit_edit_title"></h2>
            </div>

            <ul class="menu-entries list-unstyled">

                <!-- NAME -->

                <li class="space-p16">
                    <h3 class="no-space" data-ng-if="!VmAddEditCtrl.toggle.editVmName">
                        {{VmAddEditCtrl.model.name}}
                        <button type="button" class="no-style fs16 opacity4"
                                data-ng-disabled="!VmAddEditCtrl.canEditName()"
                                data-ng-click="VmAddEditCtrl.toggleEditVmName()">
                            <i class="fa fa-pencil"></i>
                        </button>
                    </h3>
                    <div data-ng-if="VmAddEditCtrl.toggle.editVmName">
                        <form name="vmNameForm" class="ovh-form-flat text-left">
                            <div flat-input-container>
                                <div class="input-group">
                                    <label for="vmName"
                                           class="input-group-addon"
                                           translate="cpcivm_addedit_server_name">
                                    </label>
                                    <input type="text" class="form-control error-animate-shake-light"
                                           id="vmName" name="vmName"
                                           placeholder="{{:: 'cpcivm_addedit_server_name' | translate}}"
                                           data-ng-model="VmAddEditCtrl.vmInEdition.name"
                                           required
                                           ng-maxlength="255"
                                           cuc-autofocus cuc-autoselect
                                           keep-label-when-empty="true"
                                           data-ng-keyup="VmAddEditCtrl.toggleEditVmName(true, $event)">
                                    <span class="input-group-btn">
                                        <button type="reset" class="btn"
                                            data-ng-click="VmAddEditCtrl.toggleEditVmName(true)">
                                            <i class="fa fa-times"></i>
                                        </button>
                                    </span>
                               </div>
                            </div>
                        </form>
                        <div class="text-left left-space-p8 right-space-p8" ng-messages="vmNameForm.vmName.$error" data-ng-if="vmNameForm.vmName.$dirty">
                            <p class="text-danger animate-fadeInLeft-enter animate-fadeOutRight-leave" ng-message="required"><span translate="cpcivm_addedit_name_add_error_required_name"></span></p>
                            <p class="text-danger animate-fadeInLeft-enter animate-fadeOutRight-leave" ng-message="maxlength"><span translate="cpcivm_addedit_name_add_error_max_char"></span></p>
                        </div>
                    </div>
                </li>

                <!-- REGIONS -->

                <li data-ng-class="{'active': VmAddEditCtrl.toggle.editDetail === 'regions'}">

                    <button type="button" class="btn btn-menu-entry"
                            data-ng-click="VmAddEditCtrl.openEditDetail('regions')"
                            data-ng-disabled="VmAddEditCtrl.loaders.panelsData.regions || !!VmAddEditCtrl.vmInEdition.saveForEdition || VmAddEditCtrl.loaders.launch">

                        <!-- loading... -->
                        <p data-ng-if="VmAddEditCtrl.loaders.panelsData.regions"
                           class="addOrEdit-menu-loading">
                            <spinner></spinner>
                            {{:: 'cpcivm_addedit_region_loading' | translate}}
                        </p>

                        <!-- content -->
                        <div data-ng-if="!VmAddEditCtrl.loaders.panelsData.regions">

                            <div data-ng-if="!VmAddEditCtrl.model.region">
                                <div class="popover-list-item opacity6">
                                    <div class="popover-list-item-illustration">
                                        <i class="fa fa-map-marker"></i>
                                    </div>
                                    <div class="popover-list-item-text">
                                        <h3 data-translate="cpcivm_addedit_region_choose"></h3>
                                    </div>
                                </div>
                            </div>

                            <div data-ng-if="VmAddEditCtrl.model.region">
                                <div class="popover-list-item popover-box">
                                    <div class="popover-list-item-illustration box-left">
                                        <i class="flag-icon {{ VmAddEditCtrl.regionService.getRegionIconFlag(VmAddEditCtrl.vmInEdition.region) }} flag"></i>
                                    </div>
                                    <div class="box-right text-left">
                                        <h3 data-ng-bind="VmAddEditCtrl.regionService.getTranslatedMicroRegion(VmAddEditCtrl.vmInEdition.region)">
                                        </h3>
                                        <h4>
                                            <span data-ng-bind="VmAddEditCtrl.regionService.getTranslatedMicroRegionLocation(VmAddEditCtrl.vmInEdition.region)"></span>
                                        </h4>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="chevron-right">
                            <div class="chevron-wrapper">
                                <i class="glyphicon glyphicon-chevron-right"></i>
                            </div>
                        </div>
                    </button>
                </li>

                <!-- IMAGES -->

                <li data-ng-class="{'active': VmAddEditCtrl.toggle.editDetail === 'images'}">

                    <button type="button" class="btn btn-menu-entry"
                            data-ng-click="VmAddEditCtrl.openEditDetail('images', 'imageId', 'type')"
                            data-ng-disabled="VmAddEditCtrl.loaders.panelsData.images || !VmAddEditCtrl.sectionCanBeModifiedInEdition('images') || VmAddEditCtrl.loaders.launch">

                        <!-- loading... -->
                        <p data-ng-if="VmAddEditCtrl.loaders.panelsData.images"
                           class="addOrEdit-menu-loading">
                            <spinner></spinner>
                            {{:: 'cpcivm_addedit_image_loading' | translate}}
                        </p>

                        <!-- content -->
                        <div data-ng-if="!VmAddEditCtrl.loaders.panelsData.images">

                            <h3 data-ng-if="!VmAddEditCtrl.model.imageId"
                               class="opacity6 no-space">
                                <i class="fa fa-desktop"></i>
                                {{:: 'cpcivm_addedit_image_choose' | translate}}
                            </h3>

                            <div data-ng-if="VmAddEditCtrl.model.imageId">

                                <div class="popover-box os-box">
                                    <div class="box-left os-left">
                                        <img class="img-circle img-circle-bordered" width="50" height="50"
                                             data-ng-src="assets/images/cloud/os/{{VmAddEditCtrl.vmInEdition.image.distribution}}_50.png"
                                             data-ng-if="VmAddEditCtrl.model.imageType === 'IMAGE' && !VmAddEditCtrl.vmInEdition.image.apps"
                                             alt="{{ VmAddEditCtrl.vmInEdition.image.name }}" />
                                        <img class="img-circle img-circle-bordered" width="50" height="50"
                                             data-ng-src="assets/images/cloud/apps/{{VmAddEditCtrl.vmInEdition.image.applications[0]}}.png"
                                             onerror="this.src='assets/images/cloud/apps/unknown.png'"
                                             data-ng-if="VmAddEditCtrl.model.imageType === 'IMAGE' && VmAddEditCtrl.vmInEdition.image.apps && VmAddEditCtrl.vmInEdition.image.applications.length > 0"
                                             alt="{{ VmAddEditCtrl.vmInEdition.image.applications[0] }}" />
                                        <img class="img-circle img-circle-bordered" width="50" height="50"
                                             data-ng-src="assets/images/cloud/apps/unknown.png"
                                             data-ng-if="VmAddEditCtrl.model.imageType === 'IMAGE' && VmAddEditCtrl.vmInEdition.image.apps && VmAddEditCtrl.vmInEdition.image.applications.length === 0"
                                             alt="application-logo" />
                                        <div class="img-snapshot"
                                            data-ng-if="VmAddEditCtrl.model.imageType === 'SNAPSHOT'">
                                            <i class="fa fa-{{VmAddEditCtrl.vmInEdition.image.type}}"
                                               data-ng-class="{'fa-question': VmAddEditCtrl.vmInEdition.image.type !== 'linux' && VmAddEditCtrl.vmInEdition.image.type !== 'windows'}"></i>
                                        </div>
                                    </div>
                                    <div class="box-right os-right text-left">
                                        <h3 class="word-break" data-ng-if="VmAddEditCtrl.vmInEdition.image.name">{{ VmAddEditCtrl.vmInEdition.image.name  }}</h3>
                                        <h3 class="word-break" data-ng-if="!VmAddEditCtrl.vmInEdition.image.name" data-translate="cpcivm_addedit_image_unknown"></h3>
                                        <h4 data-ng-if="VmAddEditCtrl.vmInEdition.image.name && VmAddEditCtrl.vmInEdition.image.type !== 'windows' && !VmAddEditCtrl.vmInEdition.image.apps"
                                            translate="cpcivm_addedit_image_{{VmAddEditCtrl.vmInEdition.image.type}}"
                                            translate-default="{{VmAddEditCtrl.vmInEdition.image.type}}"></h4>
                                        <h4 data-ng-if="VmAddEditCtrl.vmInEdition.image.apps"
                                            data-translate="cpcivm_addedit_image_apps"></h4>
                                        <h4 data-ng-if="VmAddEditCtrl.vmInEdition.image.name && VmAddEditCtrl.vmInEdition.image.type === 'windows' && VmAddEditCtrl.vmInEdition.image.price && !VmAddEditCtrl.vmInEdition.image.apps"
                                            translate="cpcivm_addedit_win_image_price_full"
                                            translate-values="{price: VmAddEditCtrl.vmInEdition.image.price[VmAddEditCtrl.vmInEdition.flavor.groupName].price.text || '?', monthly: VmAddEditCtrl.vmInEdition.image.price[VmAddEditCtrl.vmInEdition.flavor.groupName].monthlyPrice.text || '?' }"></h4>
                                    </div>
                                </div>

                            </div>
                        </div>

                        <div class="chevron-right">
                            <div class="chevron-wrapper">
                                <i class="glyphicon glyphicon-chevron-right"></i>
                            </div>
                        </div>
                    </button>
                </li>

                <!-- FLAVORS -->

                <li data-ng-class="{'active': VmAddEditCtrl.toggle.editDetail === 'flavors'}">

                    <button type="button" class="btn btn-menu-entry flavors-selector-button"
                            data-ng-click="VmAddEditCtrl.openEditDetail('flavors', 'flavorId', 'type')"
                            data-ng-disabled="VmAddEditCtrl.loaders.panelsData.flavors || !VmAddEditCtrl.sectionCanBeModifiedInEdition('flavors') || VmAddEditCtrl.loaders.launch">

                        <!-- loading... -->
                        <div data-ng-if="VmAddEditCtrl.loaders.panelsData.flavors"
                             class="addOrEdit-menu-loading">
                            <oui-spinner size="s"></oui-spinner>
                            {{:: 'cpcivm_addedit_flavor_loading' | translate}}
                        </div>

                        <!-- content -->
                        <div data-ng-if="!VmAddEditCtrl.loaders.panelsData.flavors">

                            <h3 data-ng-if="!VmAddEditCtrl.model.flavorId"
                                class="opacity6 no-space">
                                <i class="fa fa-bookmark"></i>
                                {{:: 'cpcivm_addedit_flavor_choose' | translate}}
                            </h3>

                            <div data-ng-if="VmAddEditCtrl.model.flavorId">

                                <div class="popover-box flavor-box">
                                    <div>
                                        <div class="box-left">
                                            <i class="ovh-font bottom-space-m8 {{VmAddEditCtrl.vmInEdition.flavor.typeGeneric | infrastructureFlavor:'icon'}}"></i>
                                        </div>

                                        <div class="box-right text-left">
                                            <h3 class="flavor-name">
                                                {{ VmAddEditCtrl.vmInEdition.flavor.groupName || VmAddEditCtrl.vmInEdition.flavor.name | uppercase }}
                                            </h3>
                                            <h4>
                                                <!-- if windows: take linux price -->
                                                <span translate="cpcivm_addedit_flavor_price_full"
                                                      translate-values="{price: VmAddEditCtrl.vmInEdition.flavor.associatedLinuxFlavor.price.price.text || VmAddEditCtrl.vmInEdition.flavor.price.price.text || '?', monthly: VmAddEditCtrl.vmInEdition.flavor.associatedLinuxFlavor.price.monthlyPrice.text || VmAddEditCtrl.vmInEdition.flavor.price.monthlyPrice.text || '?' }">
                                                </span>
                                            </h4>
                                        </div>
                                    </div>
                                    <div data-ng-if="VmAddEditCtrl.vmInEdition.monitoringData.cpu.needUpgrade ||
                                                     VmAddEditCtrl.vmInEdition.monitoringData.mem.needUpgrade">
                                        <div class="pull-left status-warning">
                                            <i class="ovh-font ovh-font-gauge-full ovh-font-2x"></i>
                                            <div data-ng-if="VmAddEditCtrl.vmInEdition.monitoringData.cpu.needUpgrade"
                                                 class="icon-text fs10">
                                                <span data-translate="cpcivm_addedit_flavor_upgradeAlert_cpu"></span>
                                                <span class="left-space-m4">
                                                    {{ (VmAddEditCtrl.vmInEdition.monitoringData.cpu.maxPeriod.value | number:0) + "%"}}
                                                </span>
                                            </div>
                                            <div data-ng-if="VmAddEditCtrl.vmInEdition.monitoringData.mem.needUpgrade"
                                                 class="icon-text fs10">
                                                <span data-translate="cpcivm_addedit_flavor_upgradeAlert_ram"></span>
                                                <span class="left-space-m4">
                                                    {{ (VmAddEditCtrl.vmInEdition.monitoringData.mem.maxPeriod.value /
                                                         VmAddEditCtrl.vmInEdition.monitoringData.mem.total.value * 100| number:0) + "%"}}
                                                </span>
                                            </div>
                                        </div>
                                        <div class="text-center top-space-m4"
                                             data-ng-if="VmAddEditCtrl.vmInEdition.monitoringData.cpu.needUpgrade &&
                                                         !VmAddEditCtrl.vmInEdition.monitoringData.mem.needUpgrade">
                                            <span class="fs14 status-warning-text"
                                                  data-translate="cpcivm_addedit_flavor_upgradeAlert_cpu_text"
                                                  data-translate-values="{ offer : VmAddEditCtrl.recommendedFlavorName }">
                                            </span>
                                        </div>
                                        <div class="text-center top-space-m4"
                                             data-ng-if="!VmAddEditCtrl.vmInEdition.monitoringData.cpu.needUpgrade &&
                                                         VmAddEditCtrl.vmInEdition.monitoringData.mem.needUpgrade">
                                            <span class="fs14 status-warning-text"
                                                  data-translate="cpcivm_addedit_flavor_upgradeAlert_ram_text"
                                                  data-translate-values="{ offer : VmAddEditCtrl.recommendedFlavorName }">
                                            </span>
                                        </div>
                                        <div class="text-center top-space-m4"
                                             data-ng-if="VmAddEditCtrl.vmInEdition.monitoringData.cpu.needUpgrade &&
                                                         VmAddEditCtrl.vmInEdition.monitoringData.mem.needUpgrade">
                                            <span class="fs14 status-warning-text"
                                                  data-translate="cpcivm_addedit_flavor_upgradeAlert_ram_cpu_text"
                                                  data-translate-values="{ offer : VmAddEditCtrl.recommendedFlavorName }">
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="chevron-right">
                            <div class="chevron-wrapper">
                                <i class="glyphicon glyphicon-chevron-right"></i>
                            </div>
                        </div>
                    </button>
                </li>

                <!-- SSH KEYS -->

                <li data-ng-class="{'active': VmAddEditCtrl.toggle.editDetail === 'sshKeys'}">

                    <button type="button" class="btn btn-menu-entry"
                            data-ng-click="VmAddEditCtrl.openEditDetail('sshKeys')"
                            data-ng-disabled="VmAddEditCtrl.loaders.panelsData.sshKeys || !!VmAddEditCtrl.vmInEdition.saveForEdition || VmAddEditCtrl.loaders.launch || VmAddEditCtrl.vmInEdition.image.type === 'windows'">

                        <!-- loading... -->
                        <p data-ng-if="VmAddEditCtrl.loaders.panelsData.sshKeys"
                             class="addOrEdit-menu-loading">
                            <spinner></spinner>
                            {{:: 'cpcivm_addedit_sshkey_loading' | translate}}
                        </p>

                        <!-- content -->
                        <div data-ng-if="!VmAddEditCtrl.loaders.panelsData.sshKeys">

                            <div class="popover-list-item" data-ng-class="{'opacity6' : !VmAddEditCtrl.model.sshKeyId}">
                                <div class="popover-list-item-illustration">
                                    <i class="ovh-font ovh-font-key"></i>
                                </div>
                                <div class="popover-list-item-text">
                                    <h3 data-ng-if="!VmAddEditCtrl.model.sshKeyId"
                                        class="no-space">
                                        {{:: 'cpcivm_addedit_sshkey_key_choose' | translate}}
                                        <span data-ng-if="VmAddEditCtrl.sshKeyRequired" class="red">*</span>
                                    </h3>
                                    <h3 class="no-space" data-ng-if="VmAddEditCtrl.model.sshKeyId">
                                        {{ (VmAddEditCtrl.vmInEdition.sshKey.name | limitTo:20) + ((VmAddEditCtrl.vmInEdition.sshKey.name.length > 20) ? '...' : '') }}
                                    </h3>
                                </div>
                            </div>
                        </div>

                        <div class="chevron-right">
                            <div class="chevron-wrapper">
                                <i class="glyphicon glyphicon-chevron-right"></i>
                            </div>
                        </div>
                    </button>
                </li>


                <!-- ADVANCED OPTIONS -->

                <li data-ng-class="{'active': VmAddEditCtrl.toggle.editDetail === 'advanced'}">
                    <button type="button" class="btn btn-menu-entry"
                            data-ng-click="VmAddEditCtrl.openEditDetail('advanced')"
                            data-ng-if="!VmAddEditCtrl.vmInEdition.saveForEdition"
                            data-ng-disabled="VmAddEditCtrl.loaders.panelsData.flavors || VmAddEditCtrl.loaders.launch || !VmAddEditCtrl.vmInEdition.flavor">

                        <!-- content -->
                        <div>
                            <div class="popover-list-item popover-box">
                                <div class="popover-list-item-illustration box-left">
                                    <i class="ovh-font ovh-font-config"></i>
                                </div>
                                <div class="box-right text-left">
                                    <h3 class="no-space" data-translate="cpcivm_addedit_advanced_options_title"></h3>
                                    <h4 data-translate="cpcivm_addedit_advanced_options_description"></h4>
                                </div>
                            </div>
                        </div>

                        <div class="chevron-right">
                            <div class="chevron-wrapper">
                                <i class="glyphicon glyphicon-chevron-right"></i>
                            </div>
                        </div>
                    </button>
                </li>

            </ul>

            <!-- PAYEMENT -->

            <ul class="menu-entries list-unstyled top-space-m16">
                <li>
                    <p data-ng-if="VmAddEditCtrl.vmInEdition.monthlyBilling.status === 'activationPending'" class="space-p8 space-m0">
                       <spinner class="left-space-m4 right-space-m8"></spinner>
                       <span translate="cpcivm_addedit_payement_info"></span>
                    </p>

                    <div data-ng-if="VmAddEditCtrl.vmInEdition.monthlyBilling.status !== 'activationPending'" class="row top-space-p12 bottom-space-p12 space-m0 monthlyBillingChoice" style="background:white;">

                        <button class="no-style col-xs-5 text-center space-p0 no-outline"
                            data-ng-disabled="VmAddEditCtrl.vmInEdition.monthlyBilling"
                            data-ng-click="VmAddEditCtrl.vmInEdition.monthlyBillingBoolean = false">
                            <span class="fs16" translate="cpcivm_addedit_payement_hour"
                                data-ng-class="{'bold' : !VmAddEditCtrl.vmInEdition.monthlyBillingBoolean}"></span>
                            <i class="fa fa-clock-o fs16 left-space-m4"></i><br>
                            <span class="right-space-m20 fs10" translate="cpcivm_addedit_payement_hour_info"></span>
                        </button>

                        <div class="col-xs-2 top-space-p4">
                            <flat-switch style="margin:auto;">
                                <input type="checkbox" data-ng-class="{ 'pointer' : !VmAddEditCtrl.vmInEdition.monthlyBilling }"
                                    data-ng-disabled="VmAddEditCtrl.vmInEdition.monthlyBilling"
                                    data-ng-model="VmAddEditCtrl.vmInEdition.monthlyBillingBoolean">
                            </flat-switch>
                        </div>

                        <button class="no-style col-xs-5 text-center space-p0 no-outline"
                            data-ng-disabled="VmAddEditCtrl.vmInEdition.monthlyBilling"
                            data-ng-click="VmAddEditCtrl.vmInEdition.monthlyBillingBoolean = true">
                            <i class="fa fa-calendar fs16 right-space-m4"></i>
                            <span class="fs16" translate="cpcivm_addedit_payement_month"
                                data-ng-class="{'bold' : VmAddEditCtrl.vmInEdition.monthlyBillingBoolean}"></span> <br>
                            <span class="left-space-m20 fs10" translate="cpcivm_addedit_payement_month_info"></span>
                        </button>
                    </div>

                </li>
            </ul>


            <!-- Bottom buttons -->
            <footer class="clearfix" data-ng-if="!VmAddEditCtrl.vmInEdition.saveForEdition">
                <div class="clearfix">

                    <div class="alert alert-info text-center animate-fadeInDown-enter" data-ng-if="VmAddEditCtrl.isValid() && !VmAddEditCtrl.vmInEdition.monthlyBillingBoolean && VmAddEditCtrl.vmInEdition.monthlyBilling.status !== 'activationPending'">
                        <p><i class="fa fa-info-circle"></i>
                        <span data-translate="cpcivm_addedit_payement_label"></span></p>
                    </div>

                    <button class="btn btn-primary" type="submit"
                            data-ng-click="VmAddEditCtrl.putPostVM()"
                            data-ng-disabled="VmAddEditCtrl.loaders.launch || !VmAddEditCtrl.isValid()">
                        <i class="fa fa-shopping-cart right-space-m8"></i>
                        {{:: 'cpcivm_addedit_run_now' | translate }}
                        <small class="opacity6"
                            data-ng-hide="VmAddEditCtrl.vmInEdition.monthlyBillingBoolean"
                            translate="cpcivm_addedit_flavor_price_btn"
                            translate-values="{price: VmAddEditCtrl.vmInEdition.flavor.price.price.text }"></small>
                        <small class="opacity6"
                            data-ng-show="VmAddEditCtrl.vmInEdition.monthlyBillingBoolean"
                            translate="cpcivm_addedit_flavor_monthlyPrice_btn"
                            translate-values="{price: VmAddEditCtrl.vmInEdition.flavor.price.monthlyPrice.text }"></small>
                        <span data-ng-if="VmAddEditCtrl.model.vmCount > 1">
                            <strong>x{{VmAddEditCtrl.model.vmCount}}</strong>
                        </span>
                        <spinner name="bubbles-fff-ffcd1a-16" data-ng-show="VmAddEditCtrl.loaders.launch"></spinner>
                    </button>
                    <button class="btn btn-default" type="reset"
                            data-ng-click="VmAddEditCtrl.cancelVm()"
                            data-ng-disabled="VmAddEditCtrl.loaders.launch">
                            <i class="glyphicon glyphicon-remove"></i>
                            <span data-translate="common_cancel"></span>
                    </button>
                </div>
                <div class="clearfix">
                    <p data-ng-if="VmAddEditCtrl.sshKeyRequired && !VmAddEditCtrl.model.sshKeyId"
                        class="top-space-m8 fs10 red pull-right ">
                        * <span translate="common_required_field"></span>
                    </p>
                </div>
            </footer>

            <!-- Bottom buttons -->
            <footer class="clearfix" data-ng-if="!!VmAddEditCtrl.vmInEdition.saveForEdition">

                <div class="alert alert-info text-center animate-fadeInDown-enter" data-ng-class="{ 'bottom-space-m16' : VmAddEditCtrl.vmInEdition.hasChange('images') }" data-ng-if="!VmAddEditCtrl.vmInEdition.monthlyBillingBoolean && VmAddEditCtrl.vmInEdition.monthlyBilling.status !== 'activationPending'">
                    <p><i class="fa fa-info-circle right-space-p4"></i>
                    <span data-translate="cpcivm_addedit_payement_label"></span></p>
                </div>

                <!-- reinstall warning -->
                <div class="alert alert-danger text-center" data-ng-if="VmAddEditCtrl.vmInEdition.hasChange('images')">
                    <p><i class="fa fa-exclamation-circle"></i> <span data-translate="cpci_vm_reinstall_warn"></span></p>
                </div>

                <!-- flavor change warning -->
                <div class="alert alert-danger text-center" data-ng-if="VmAddEditCtrl.vmInEdition.hasChange('flavors')">
                    <p><i class="fa fa-exclamation-circle"></i> <span data-translate="cpcivm_addedit_flavor_downtime_warn"></span></p>
                </div>

                <div class="text-center animate-fadeIn-enter"
                    data-ng-hide="VmAddEditCtrl.vmInEdition.hasChange()">
                    <button class="btn btn-default"
                        data-translate="common_close"
                        data-ng-click="VmAddEditCtrl.cancelVm()">
                    </button>
                </div>

                <div class="clearfix">
                    <button  class="btn btn-primary animate-fadeInLeft-enter" type="submit"
                        data-ng-show="VmAddEditCtrl.vmInEdition.hasChange()"
                        data-ng-click="VmAddEditCtrl.putPostVM()"
                        at-internet-click="{ name : 'cloud-project::cloud-project-compute::cloud-project-compute-infrastructure-add-virtual-machine-launch' }"
                        data-ng-disabled="VmAddEditCtrl.loaders.launch || !VmAddEditCtrl.isValid()">
                        <i class="fa fa-check right-space-m8"></i>
                        {{:: 'cpcivm_addedit_change_now' | translate }}

                        <small class="opacity6"
                            data-ng-show="!VmAddEditCtrl.vmInEdition.monthlyBillingBoolean && (VmAddEditCtrl.vmInEdition.hasChange('flavors') || (VmAddEditCtrl.vmInEdition.saveForEdition.monthlyBillingBoolean !== VmAddEditCtrl.vmInEdition.monthlyBillingBoolean))"
                            translate="cpcivm_addedit_flavor_price_btn"
                            translate-values="{price: VmAddEditCtrl.vmInEdition.flavor.price.price.text }"></small>
                        <small class="opacity6"
                            data-ng-show="VmAddEditCtrl.vmInEdition.monthlyBillingBoolean && (VmAddEditCtrl.vmInEdition.hasChange('flavors') || (VmAddEditCtrl.vmInEdition.saveForEdition.monthlyBillingBoolean !== VmAddEditCtrl.vmInEdition.monthlyBillingBoolean))"
                            translate="cpcivm_addedit_flavor_monthlyPrice_btn"
                            translate-values="{price: VmAddEditCtrl.vmInEdition.flavor.price.monthlyPrice.text }"></small>

                        <spinner name="bubbles-fff-ffcd1a-16" data-ng-show="VmAddEditCtrl.loaders.launch"></spinner>

                    </button>

                    <button class="btn btn-default animate-fadeInRight-enter" type="reset"
                        data-ng-show="VmAddEditCtrl.vmInEdition.hasChange()"
                        data-ng-click="VmAddEditCtrl.cancelVm()"
                        data-ng-disabled="VmAddEditCtrl.loaders.launch">
                        <i class="glyphicon glyphicon-remove right-space-m8"></i>
                        <span data-translate="common_cancel"></span>
                    </button>
                </div>

                <div class="clearfix">
                    <p data-ng-if="VmAddEditCtrl.sshKeyRequired && !VmAddEditCtrl.model.sshKeyId"
                        class="top-space-m8 fs10 red pull-right ">
                        * <span translate="common_required_field"></span>
                    </p>
                </div>
            </footer>


        </div>

<!-- _____________________________________________________RIGHT PANEL____________________________________________________________ -->

        <!--
            responsive-switch-page
            moveRightFromMiddle
            moveFromRightFade
         -->

        <div data-responsive-switch-page class="responsive-switch-page-right">
            <div data-ng-switch on="VmAddEditCtrl.toggle.editDetail" class="animate-switch-container">

                <!-- Back btn -->
                <div class="switch-page-top" data-ng-if="VmAddEditCtrl.isSwitchMode() && VmAddEditCtrl.toggle.editDetail !== 'sshKeys-help'">
                    <button type="button" class="btn no-style back-btn"
                            data-ng-click="VmAddEditCtrl.backToMenu()">
                        <i class="fa fa-angle-left"></i>
                        <span data-translate="cpcivm_addedit_back"></span>
                    </button>
                </div>


                <!-- ___ FLAVORS ___ -->

                <div data-ng-switch-when="flavors" class="animate-switch">
                    <!-- Title-->
                    <h3 class="title text-center"
                        data-ng-if="VmAddEditCtrl.isSwitchMode()"
                        data-translate="cpcivm_addedit_change_flavors_title">
                    </h3>
                    <!-- loading -->
                    <p data-ng-if="VmAddEditCtrl.loaders.panelsData.flavors"
                       class="popover-detail-item text-center">
                        <spinner></spinner>
                        {{:: 'cpcivm_addedit_flavor_loading' | translate}}
                    </p>

                    <!-- content -->
                    <div data-ng-if="!VmAddEditCtrl.loaders.panelsData.flavors">
                        <!-- no datas -->
                        <p class="popover-detail-item text-center" data-ng-if="!VmAddEditCtrl.panelsData.flavors.length">
                            <i class="fa fa-bug"></i>
                            <span translate="cpcivm_addedit_flavor_error"></span>
                            <br><br>
                            <button class="btn btn-secondary" type="button"
                                    data-ng-click="VmAddEditCtrl.getFlavors()">
                                <i class="glyphicon glyphicon-refresh white"></i>
                                <span translate="cpcivm_addedit_flavor_refresh"></span>
                            </button>
                        </p>
                        <div class="pull-left text-underline"
                             data-ng-if="VmAddEditCtrl.states.hasOldFlavors">
                            <span>*</span>
                            <span data-translate="cpcivm_addedit_flavor_has_old_flavors"></span>
                        </div>
                        <!-- quota explain -->
                        <div data-ng-if="VmAddEditCtrl.panelsData.flavors.length && VmAddEditCtrl.panelsData.quota && VmAddEditCtrl.displayData.quota"
                             class="text-muted text-right bottom-space-m8 right-space-m8">

                            <div class="inline-block right-space-m8"
                                 data-uib-tooltip="{{::'cpcivm_addedit_flavor_quota_vcpus'|translate}}"
                                 data-tooltip-placement="bottom">
                                <i class="ovh-font ovh-font-cloudcpu inline-block vertical-middle"></i>
                                <span data-ng-if="VmAddEditCtrl.displayData.quota.instance.maxCores === -1" class="vertical-middle fs10">
                                    {{ :: VmAddEditCtrl.displayData.quota.instance.usedCores }} / {{ :: 'cloud_common_unlimited' | translate }}
                                </span>
                                <span data-ng-if="VmAddEditCtrl.displayData.quota.instance.maxCores > -1" class="vertical-middle fs10">
                                    {{ :: VmAddEditCtrl.displayData.quota.instance.usedCores }} / {{ :: VmAddEditCtrl.displayData.quota.instance.maxCores }}
                                </span>
                            </div>

                            <div class="inline-block"
                                 data-uib-tooltip="{{::'cpcivm_addedit_flavor_quota_ram'|translate}}"
                                 data-tooltip-placement="bottom">
                                <i class="ovh-font ovh-font-cloudram inline-block vertical-middle"></i>
                                <span data-ng-if="VmAddEditCtrl.displayData.quota.instance.maxRam === -1" class="vertical-middle fs10">
                                    {{ :: VmAddEditCtrl.displayData.quota.instance.usedRAM > 0 ? ((VmAddEditCtrl.displayData.quota.instance.usedRAM * 1000000) | bytes:2) : VmAddEditCtrl.displayData.quota.instance.usedRAM }} / {{ :: 'cloud_common_unlimited' | translate }}
                                </span>
                                <span data-ng-if="VmAddEditCtrl.displayData.quota.instance.maxRam > -1" class="vertical-middle fs10">
                                    {{ :: VmAddEditCtrl.displayData.quota.instance.usedRAM > 0 ? ((VmAddEditCtrl.displayData.quota.instance.usedRAM * 1000000) | bytes:2) : VmAddEditCtrl.displayData.quota.instance.usedRAM }} / {{ :: (VmAddEditCtrl.displayData.quota.instance.maxRam * 1000000) | bytes:2 }}
                                </span>
                            </div>
                        </div>
                        <!-- Categories -->
                        <uib-accordion close-others="true" data-ng-if="VmAddEditCtrl.panelsData.flavors.length">
                            <uib-accordion-group data-ng-repeat="categoryObject in VmAddEditCtrl.displayData.categories track by $index"
                                             data-is-open="VmAddEditCtrl.toggle.accordions.flavors[categoryObject.category]"
                                             data-is-disabled="!categoryObject.flavors.length">
                                <uib-accordion-heading>
                                    <div class="{{VmAddEditCtrl.toggle.accordions.flavors[categoryObject.category] ? 'active' : categoryObject.flavors.length ? '' : 'disabled'}}">
                                        <div class="chevron-left">
                                            <i class="glyphicon pull-left"
                                               ng-class="{'glyphicon-chevron-down': VmAddEditCtrl.toggle.accordions.flavors[categoryObject.category], 'glyphicon-chevron-right': !VmAddEditCtrl.toggle.accordions.flavors[categoryObject.category]}"></i>
                                        </div>
                                        <div class="accordion-heading-title">
                                            <span data-translate="cpcivm_addedit_flavor_{{ categoryObject.category }}"></span>
                                            <small data-ng-show="VmAddEditCtrl.hasWindowsCompatibilityIssue(categoryObject.category)" data-translate="cpcivm_addedit_image_windows_incompatibility" class="accordion-heading-title__information"></small>
                                        </div>
                                    </div>
                                    <p class="alert alert-warning text-center top-space-m8" data-ng-if="!categoryObject.flavors.length && categoryObject.category === 'accelerated'">
                                        <i class="fa fa-warning"></i>
                                        <span data-translate="cpcivm_addedit_flavor_not_available_region"></span>
                                    </p>
                                </uib-accordion-heading>

                                <div data-ng-switch on="VmAddEditCtrl.toggle.editFlavor">
                                    <div data-ng-switch-when="categories">
                                        <dl data-ng-if="!VmAddEditCtrl.isCurrentCategory(categoryObject.category)"
                                            class="dl-edit-instance">
                                            <dt data-translate="cpcivm_addedit_table_model"></dt>
                                            <dd>-</dd>
                                            <dt data-translate="cpcivm_addedit_table_cpu"></dt>
                                            <dd>
                                                <button type="button" class="btn" data-ng-click="VmAddEditCtrl.viewFlavorsList('vcpus', categoryObject.category)">
                                                    <span class="upgradable"
                                                          data-translate="cpcivm_addedit_table_core_pick"
                                                          >
                                                    </span>
                                                    <div class="chevron-right">
                                                        <div class="chevron-wrapper">
                                                            <i class="glyphicon glyphicon-chevron-right"></i>
                                                        </div>
                                                    </div>
                                                </button>
                                            </dd>
                                            <dt data-translate="cpcivm_addedit_table_ram"></dt>
                                            <dd>
                                                <button type="button" class="btn" data-ng-click="VmAddEditCtrl.viewFlavorsList('ram', categoryObject.category)">
                                                    <span class="upgradable"
                                                          data-translate="cpcivm_addedit_table_ram_pick">
                                                    </span>
                                                    <div class="chevron-right">
                                                        <div class="chevron-wrapper">
                                                            <i class="glyphicon glyphicon-chevron-right"></i>
                                                        </div>
                                                    </div>
                                                </button>
                                            </dd>
                                            <dt data-translate="cpcivm_addedit_table_disk"></dt>
                                            <dd>-</dd>
                                            <dt data-translate="cpcivm_addedit_table_network"></dt>
                                            <dd>-</dd>

                                        </dl>
                                        <dl data-ng-if="VmAddEditCtrl.isCurrentCategory(categoryObject.category)"
                                            class="dl-edit-instance">
                                            <p class="alert alert-warning text-center" data-ng-if="VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category].disabled || VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category].deprecated">
                                                <i class="fa fa-warning"></i>
                                                <span>{{ VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category].disabled ?
                                                    ('cpcivm_addedit_flavor_disabled_' + VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category].disabled | translate)
                                                    : (VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category].deprecated ? ('cpcivm_addedit_flavor_deprecated' | translate) : '')}}
                                                </span>
                                            </p>
                                            <dt data-translate="cpcivm_addedit_table_model"></dt>
                                            <dd>
                                                <span data-ng-bind-html="'cpci_vm_flavor_category_' + VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category].name | translate"></span>
                                                <span data-ng-if="VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category].isOldFlavor">*</span>
                                            </dd>
                                            <dt data-translate="cpcivm_addedit_table_cpu"></dt>
                                            <dd>
                                                <button type="button" class="btn" data-ng-click="VmAddEditCtrl.viewFlavorsList('vcpus', categoryObject.category)">
                                                    <span class="upgradable"
                                                          data-translate="cpcivm_addedit_table_core_details"
                                                          data-translate-values="{ vCores: VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category].vcpus, frequency: (VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category].frequency | number) }">
                                                    </span>
                                                    <div class="chevron-right">
                                                        <div class="chevron-wrapper">
                                                            <i class="glyphicon glyphicon-chevron-right"></i>
                                                        </div>
                                                    </div>
                                                </button>
                                            </dd>
                                            <dt data-translate="cpcivm_addedit_table_ram"></dt>
                                            <dd>
                                                <button type="button" class="btn" data-ng-click="VmAddEditCtrl.viewFlavorsList('ram', categoryObject.category)">
                                                    <span class="upgradable"
                                                          data-translate="cpcivm_addedit_table_ram_details"
                                                          data-translate-values="{ size: (VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category].ram * 1000000 | bytes) }">
                                                    </span>
                                                    <div class="chevron-right">
                                                        <div class="chevron-wrapper">
                                                            <i class="glyphicon glyphicon-chevron-right"></i>
                                                        </div>
                                                    </div>
                                                </button>
                                            </dd>
                                            <dt data-ng-if="categoryObject.category === 'accelerated'"
                                                data-translate="cpcivm_addedit_table_gpu"></dt>
                                            <dd data-ng-if="categoryObject.category === 'accelerated'">
                                                <div data-ng-bind="'cpcivm_addedit_table_gpu_' + VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category].shortType | translate: { cardCount: VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category].gpuCardCount }"></div>
                                            </dd>
                                            <dt data-translate="cpcivm_addedit_table_disk"></dt>
                                            <dd data-ng-if="categoryObject.category === 'vps' || (categoryObject.category !== 'vps' && VmAddEditCtrl.getFlavorOfCurrentRegionAndOSType(VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category], 'ceph', false) === undefined)">
                                                <div data-translate="cpcivm_addedit_table_disk_details_ssd"
                                                     data-translate-values="{ size: (VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category].disk | bytes:2:true:'GiB') }"></div>

                                                <div data-ng-show="VmAddEditCtrl.showFlex(categoryObject.category)">
                                                    <div class="checkbox" data-ng-disabled="VmAddEditCtrl.isIncompatible(categoryObject.category, 'ssd')">
                                                        <label data-uib-tooltip="{{ VmAddEditCtrl.isIncompatible(categoryObject.category, 'ssd') ? ('cpcivm_addedit_flavor_disabled_NO_FLEX' | translate) : '' }}">
                                                            <input type="checkbox"
                                                                data-ng-model="VmAddEditCtrl.model.flex"
                                                                data-ng-click="VmAddEditCtrl.selectFlavor(categoryObject.category, VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category])"
                                                                data-ng-disabled="VmAddEditCtrl.isIncompatible(categoryObject.category, 'ssd')">
                                                            <span data-translate="cpcivm_addedit_table_flex_pick"></span>
                                                        </label>
                                                    </div>
                                                    <div class="flex-details"
                                                        data-ng-if="VmAddEditCtrl.model.flex"
                                                        data-translate="cpcivm_addedit_table_flex_details">
                                                    </div>
                                                </div>
                                            </dd>
                                            <dd data-ng-if="VmAddEditCtrl.showCeph(categoryObject.category)">
                                                <div class="btn-group btn-disks top-space-m8" role="group">
                                                    <button type="button"
                                                            class="btn"
                                                            data-ng-click="VmAddEditCtrl.selectDiskType('ceph', categoryObject.category)"
                                                            data-ng-class="{'active': VmAddEditCtrl.model.diskType === 'ceph'}"
                                                            data-ng-disabled="VmAddEditCtrl.isIncompatible(categoryObject.category, 'ceph')"
                                                            data-uib-tooltip="{{:: VmAddEditCtrl.isIncompatible(categoryObject.category, 'ceph') ? ('cpcivm_addedit_flavor_disabled_WRONG_DISK_TYPE' | translate) : '' }}">
                                                        <span data-ng-bind-html="'cpcivm_addedit_table_disk_details_ha_with_size' | translate: { size:  (VmAddEditCtrl.getFlavorOfCurrentRegionAndOSType(VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category], 'ceph', VmAddEditCtrl.model.flex).disk |  bytes: 2:true:'GiB') }">
                                                        </span>
                                                    </button>
                                                    <button type="button"
                                                            class="btn"
                                                            data-ng-click="VmAddEditCtrl.selectDiskType('ssd', categoryObject.category)"
                                                            data-ng-class="{'active': VmAddEditCtrl.model.diskType === 'ssd'}"
                                                            data-ng-disabled="VmAddEditCtrl.isIncompatible(categoryObject.category, 'ssd')"
                                                            data-uib-tooltip="{{:: VmAddEditCtrl.isIncompatible(categoryObject.category, 'ssd') ? ('cpcivm_addedit_flavor_disabled_WRONG_DISK_TYPE' | translate) : '' }}">
                                                        <span data-ng-bind-html="'cpcivm_addedit_table_disk_details_ssd_with_size' | translate: { size:  (VmAddEditCtrl.getFlavorOfCurrentRegionAndOSType(VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category], 'ssd', VmAddEditCtrl.model.flex).disk | bytes: 2:true:'GiB') }">
                                                        </span>
                                                    </button>
                                                </div>
                                                <div class="checkbox" data-ng-disabled="VmAddEditCtrl.isIncompatible(categoryObject.category)">
                                                    <label data-uib-tooltip="{{ VmAddEditCtrl.isIncompatible(categoryObject.category) ? ('cpcivm_addedit_flavor_disabled_NO_FLEX' | translate) : '' }}">
                                                        <input type="checkbox"
                                                            data-ng-model="VmAddEditCtrl.model.flex"
                                                            data-ng-click="VmAddEditCtrl.selectFlavor(categoryObject.category, VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category])"
                                                            data-ng-disabled="VmAddEditCtrl.isIncompatible(categoryObject.category)">
                                                        <span data-translate="cpcivm_addedit_table_flex_pick"></span>
                                                    </label>
                                                </div>
                                                <div class="flex-details"
                                                     data-ng-if="VmAddEditCtrl.model.flex"
                                                     data-translate="cpcivm_addedit_table_flex_details"></div>
                                            </dd>
                                            <dt data-translate="cpcivm_addedit_table_network"></dt>
                                            <dd data-ng-if="VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category].outboundBandwidth >= 1024"
                                                data-translate="cpcivm_addedit_table_network_details_giga"
                                                data-translate-values="{ size: (VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category].outboundBandwidth / 1024 | number: 1) }"></dd>
                                            <dd data-ng-if="VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category].outboundBandwidth < 1024"
                                                data-translate="cpcivm_addedit_table_network_details_mega"
                                                data-translate-values="{ size: VmAddEditCtrl.categoriesVmInEditionFlavor[categoryObject.category].outboundBandwidth }"></dd>

                                            <dd data-translate="cpcivm_addedit_table_guaranteed" data-ng-if="VmAddEditCtrl.hasGuaranteedRessources(categoryObject.category)"></dd>
                                        </dl>
                                    </div>
                                    <div data-ng-switch-when="flavors">
                                        <form>
                                            <table class="table table-pretty table-hover table-striped table-flavors">
                                                <thead>
                                                    <tr>
                                                        <th>&nbsp;</th>
                                                        <th>
                                                            <button class="no-style">
                                                                <label data-translate="cpcivm_addedit_table_type">
                                                                </label>
                                                            </button>
                                                        </th>
                                                        <th>
                                                            <button class="no-style"
                                                                    data-ng-click="VmAddEditCtrl.orderBy('vcpus', categoryObject.category)">
                                                                <label class="pointer"
                                                                       data-translate="cpcivm_addedit_table_core">
                                                                </label>
                                                                <span data-ng-class="{ 'filter': VmAddEditCtrl.order.by === 'vcpus' }">
                                                                </span>
                                                            </button>
                                                        </th>
                                                        <th>
                                                            <button class="no-style"
                                                                    data-ng-click="VmAddEditCtrl.orderBy('ram', categoryObject.category)">
                                                                <label class="pointer"
                                                                       data-translate="cpcivm_addedit_table_ram">
                                                                </label>
                                                                <span data-ng-class="{ 'filter': VmAddEditCtrl.order.by === 'ram' }">
                                                                </span>
                                                            </button>
                                                        </th>
                                                        <th>
                                                            <button class="no-style"
                                                                    data-ng-click="VmAddEditCtrl.orderBy('disk', categoryObject.category)">
                                                                <label class="pointer"
                                                                       data-translate="cpcivm_addedit_table_disk">
                                                                </label>
                                                                <span data-ng-class="{ 'filter': VmAddEditCtrl.order.by === 'disk' }">
                                                                </span>
                                                            </button>
                                                        </th>
                                                        <th>
                                                            <button class="no-style"
                                                                    data-ng-click="VmAddEditCtrl.orderBy('price.price.value', categoryObject.category)">
                                                                <label class="pointer">
                                                                    <span data-translate="cpcivm_addedit_price"></span>*
                                                                </label>
                                                                <span data-ng-class="{ 'filter': VmAddEditCtrl.order.by === 'price.price.value' }">
                                                                </span>
                                                            </button>
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr data-ng-repeat-start="flavor in categoryObject.flavors track by flavor.id"
                                                        data-ng-click="VmAddEditCtrl.selectFlavor(categoryObject.category, flavor)"
                                                        data-ng-mouseenter="VmAddEditCtrl.onMouseEnterFlavor(categoryObject.category, flavor)"
                                                        data-ng-class="{'disabled opacity5': flavor.disabled || flavor.deprecated || !flavor.available}"
                                                        class="pointer" role="button" tabindex="0" cuc-click-enter-on-keypress
                                                        data-uib-tooltip="{{:: flavor.disabled ? ('cpcivm_addedit_flavor_disabled_' + flavor.disabled | translate) : (flavor.deprecated ? ('cpcivm_addedit_flavor_deprecated' | translate) : '') }}">
                                                        <td class="text-center">
                                                            <flat-radio>
                                                                <input type="radio" aria-hidden="true" tabindex="-1"
                                                                       name="flavorsChoice" id="{{:: flavor.shortGroupName }}"
                                                                       data-ng-value="flavor.shortGroupName"
                                                                       data-ng-disabled="flavor.disabled || !flavor.available"
                                                                       data-ng-model="VmAddEditCtrl.displayData.shortGroupName">
                                                            </flat-radio>
                                                        </td>
                                                        <td class="text-center">
                                                            <label for="{{:: flavor.shortGroupName }}" class="bold">
                                                                <span data-ng-bind="'cpci_vm_flavor_category_' + flavor.shortGroupName | translate"></span>
                                                                <span data-ng-if="flavor.isOldFlavor">*</span>
                                                            </label>
                                                        </td>
                                                        <td class="text-center"
                                                            data-translate="cpcivm_addedit_table_core_details_short"
                                                            data-translate-values="{ vCores: flavor.vcpus, frequency: flavor.frequency }"></td>
                                                        <td class="text-center" data-ng-bind="::flavor.ram * 1000000 | bytes"></td>
                                                        <td>
                                                            <div class="text-left"
                                                                 data-ng-if="flavor.vps"
                                                                 data-translate="cpcivm_addedit_table_disk_short_ssd"
                                                                 data-translate-values="{ size: (flavor.disk | bytes: 2:true:'GiB') }"></div>
                                                            <div data-ng-if="!flavor.vps && VmAddEditCtrl.getFlavorOfCurrentRegionAndOSType(flavor, 'ceph', false) !== undefined">
                                                                <div class="text-left"
                                                                     data-translate="cpcivm_addedit_table_disk_short_ha"
                                                                     data-translate-values="{ size: (VmAddEditCtrl.getFlavorOfCurrentRegionAndOSType(flavor, 'ceph', false).disk | bytes: 2:true:'GiB')}"></div>
                                                                <div class="text-left"
                                                                     data-translate="cpcivm_addedit_table_disk_short_ssd_or"
                                                                     data-translate-values="{ size: (VmAddEditCtrl.getFlavorOfCurrentRegionAndOSType(flavor, 'ssd', false).disk | bytes: 2:true:'GiB') }"></div>
                                                            </div>
                                                            <div data-ng-if="!flavor.vps && VmAddEditCtrl.getFlavorOfCurrentRegionAndOSType(flavor, 'ceph', false) === undefined">
                                                                <div class="text-left"
                                                                 data-translate="cpcivm_addedit_table_disk_short_ssd"
                                                                 data-translate-values="{ size: (flavor.disk | bytes: 2:true:'GiB') }"></div>
                                                            </div>
                                                        </td>

                                                        <td class="text-right">
                                                            <span data-ng-if="!VmAddEditCtrl.vmInEdition.monthlyBillingBoolean"
                                                                  data-translate="cpcivm_addedit_flavor_price"
                                                                  data-translate-values="{ price: flavor.associatedLinuxFlavor.price.price.text || flavor.price.price.text || '?' }">
                                                            </span>
                                                            <span data-ng-if="VmAddEditCtrl.vmInEdition.monthlyBillingBoolean"
                                                                  data-translate="cpcivm_addedit_flavor_monthlyPrice"
                                                                  data-translate-values="{ price: flavor.associatedLinuxFlavor.price.monthlyPrice.text || flavor.price.monthlyPrice.text || '?' }">
                                                            </span>
                                                        </td>
                                                    </tr>
                                                    <tr data-ng-repeat-end
                                                        data-ng-if="!flavor.available"
                                                        data-ng-class="{'disabled opacity5': !flavor.available}">
                                                        <td colspan="6" class="bottom-message">
                                                            <span data-translate="cpcivm_addedit_flavor_not_available_region"></span>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                                <tfoot>
                                                    <td colspan="6">
                                                        <span data-translate="cpcivm_addedit_table_price"></span>
                                                    </td>
                                                </tfoot>
                                            </table>
                                        </form>
                                    </div>
                                </div>
                            </uib-accordion-group>
                        </uib-accordion>
                    </div>
                    <div class="inline-block text-center fs10 left-space-m8 right-space-m8 top-space-m8"
                         data-ng-if="VmAddEditCtrl.vmInEdition.status !== 'DRAFT' && VmAddEditCtrl.vmInEdition.image.type === 'windows'">
                        <i class="fa fa-question-circle"></i>
                        {{'cpcivm_addedit_flavor_guidelines' | translate }}
                        <a class="left-space-m4" data-ng-if="VmAddEditCtrl.guideURL" href="{{VmAddEditCtrl.guideURL}}" target="_blank" >
                            {{:: 'cpcivm_addedit_flavor_howto' | translate }}
                            <i class="fa fa-external-link"></i>
                        </a>
                    </div>
                </div>

                <!-- ___ IMAGES ___ -->

                <div data-ng-switch-when="images" class="animate-switch">

                    <h3 class="title text-center"
                        data-ng-if="VmAddEditCtrl.isSwitchMode()"
                        data-translate="cpcivm_addedit_change_image_title">
                    </h3>

                    <p class="fs10" data-ng-if="VmAddEditCtrl.vmInEdition.status=='DRAFT'">
                        {{:: 'cpcivm_addedit_image_windows_change' | translate}}
                    </p>

                    <p class="text-muted inline-block red fs10"
                           data-ng-if="VmAddEditCtrl.model.imageType === 'SNAPSHOT'"
                           translate="cpcivm_addedit_snapshot_cannot_delete_installed_snapshot">
                    </p>

                    <!-- loading... -->
                    <p data-ng-if="VmAddEditCtrl.loaders.panelsData.images || VmAddEditCtrl.loaders.panelsData.snapshots"
                       class="popover-detail-item text-center">
                        <spinner></spinner>
                        {{:: 'cpcivm_addedit_image_loading' | translate}}
                    </p>

                    <!-- content -->
                    <div data-ng-if="!VmAddEditCtrl.loaders.panelsData.images">

                        <!-- no datas -->
                        <p class="popover-detail-item text-center" data-ng-if="!VmAddEditCtrl.panelsData.images.length">
                            <i class="fa fa-bug"></i>
                            <span translate="cpcivm_addedit_image_error"></span>
                            <br><br>
                            <button class="btn btn-secondary" type="button"
                                    data-ng-click="VmAddEditCtrl.getFlavors()">
                                <i class="glyphicon glyphicon-refresh white"></i>
                                <span translate="cpcivm_addedit_image_refresh"></span>
                            </button>
                        </p>

                        <uib-accordion close-others="true"
                                   data-ng-if="!VmAddEditCtrl.loaders.panelsData.images">

                            <!-- OS -->
                            <!-- class instead of ng-class for uib-accordion-group, this is a known issues of angular-ui-bootsrap -->
                            <uib-accordion-group data-is-open="VmAddEditCtrl.toggle.accordions.images[imageType]"
                                data-ng-repeat="(imageType, images) in VmAddEditCtrl.displayData.images"
                                class="{{VmAddEditCtrl.toggle.accordions.images[imageType] ? 'active' : images.length ? '' : 'disabled'}}"
                                data-is-disabled="!images.length">

                                <uib-accordion-heading>
                                    <span class="accordion-heading-title" data-translate="cpcivm_addedit_image_{{::imageType}}"></span>
                                    <small data-ng-if="!images.length && VmAddEditCtrl.vmInEdition.flavor.vps" data-translate="cpcivm_addedit_image_windows_incompatibility" class="accordion-heading-title__information"></small>
                                    <small data-ng-if="!images.length && !VmAddEditCtrl.vmInEdition.flavor.vps" data-translate="cpcivm_addedit_image_recommended_none" class="accordion-heading-title__information"></small>
                                    <div class="chevron-right">
                                        <i class="glyphicon pull-right" ng-class="{'glyphicon-chevron-down': VmAddEditCtrl.toggle.accordions.images[imageType], 'glyphicon-chevron-right': !VmAddEditCtrl.toggle.accordions.images[imageType]}"></i>
                                    </div>
                                </uib-accordion-heading>

                                <table class="table table-pretty table-hover table-striped shadow-z-1">
                                    <tbody>
                                        <tr data-ng-repeat="image in images track by image.id"
                                            data-ng-click="VmAddEditCtrl.model.imageId = (image.disabled || !VmAddEditCtrl.isImageSelectableInEditMode(image)) ? VmAddEditCtrl.model.imageId : image.id"
                                            data-ng-class="{'disabled opacity5': image.disabled || image.deprecated || !VmAddEditCtrl.isImageSelectableInEditMode(app) }"
                                            class="pointer" role="button" tabindex="0" cuc-click-enter-on-keypress
                                            data-uib-tooltip="{{:: image.disabled ? ('cpcivm_addedit_image_disabled_' + image.disabled | translate) : (image.deprecated ? ('cpcivm_addedit_image_deprecated' | translate) : '') }}">

                                            <td style="width: 50px;">
                                                <flat-radio>
                                                    <input type="radio" aria-hidden="true" tabindex="-1"
                                                           name="imagesChoice" id="{{::image.id}}"
                                                           data-ovh-stop-event="click"
                                                           value="{{::image.id}}"
                                                           data-ng-disabled="image.disabled || !VmAddEditCtrl.isImageSelectableInEditMode(image)"
                                                           data-ng-model="VmAddEditCtrl.model.imageId">
                                                </flat-radio>
                                            </td>
                                            <td class="no-space top-space-p8 bottom-space-p8" style="width: 50px;">
                                                <img class="img-circle img-circle-bordered" width="50" height="50"
                                                     data-ng-src="assets/images/cloud/os/{{:: image.distribution}}_50.png"
                                                     alt="{{:: image.distribution }}" />
                                            </td>
                                            <td>
                                                <label for="{{::image.id}}" class="fs14 no-space normal">
                                                    <span translate="cloud_os_{{:: image.name}}" translate-default="{{:: image.name}}"></span>
                                                    <small class="text-muted inline-block"
                                                           data-ng-if="image.type === 'windows' && image.price[VmAddEditCtrl.vmInEdition.flavor.groupName]"
                                                           translate="cpcivm_addedit_win_image_price_full"
                                                           translate-values="{price: image.price[VmAddEditCtrl.vmInEdition.flavor.groupName].price.text || '?', monthly: image.price[VmAddEditCtrl.vmInEdition.flavor.groupName].monthlyPrice.text || '?' }">
                                                    </small>
                                                </label>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </uib-accordion-group>

                            <!-- Apps -->
                            <!-- class instead of ng-class un uib-accordion-group is a known issues over of angular-ui-bootsrap -->
                            <uib-accordion-group data-is-open="VmAddEditCtrl.toggle.accordions.images.apps"
                                                 class="{{VmAddEditCtrl.toggle.accordions.images.apps ? 'active': ''}}">
                                <uib-accordion-heading>
                                    <span data-translate="cpcivm_addedit_image_apps"></span>

                                    <div class="chevron-right">
                                        <i class="glyphicon pull-right" ng-class="{'glyphicon-chevron-down': VmAddEditCtrl.toggle.accordions.images.apps, 'glyphicon-chevron-right': !VmAddEditCtrl.toggle.accordions.images.apps}"></i>
                                    </div>
                                </uib-accordion-heading>

                                <table class="table table-pretty table-hover table-striped shadow-z-1">
                                    <tbody>
                                        <p data-translate="cpcivm_addedit_image_application_warning"></p>
                                        <tr data-ng-repeat="app in VmAddEditCtrl.displayData.apps track by app.id"
                                            data-ng-click="VmAddEditCtrl.model.imageId = (app.disabled || !VmAddEditCtrl.isImageSelectableInEditMode(app)) ? VmAddEditCtrl.model.imageId : app.id"
                                            data-ng-class="{'disabled opacity5': app.disabled || app.deprecated || !VmAddEditCtrl.isImageSelectableInEditMode(app) }"
                                            class="pointer" role="button" tabindex="0" cuc-click-enter-on-keypress
                                            data-uib-tooltip="{{:: app.disabled ? ('cpcivm_addedit_image_disabled_' + app.disabled | translate) : (app.deprecated ? ('cpcivm_addedit_image_deprecated' | translate) : '') }}">

                                            <td style="width: 50px;">
                                                <flat-radio>
                                                    <input type="radio" aria-hidden="true" tabindex="-1"
                                                           name="imagesChoice" id="{{::app.id}}"
                                                           data-ovh-stop-event="click"
                                                           value="{{::app.id}}"
                                                           data-ng-disabled="app.disabled || !VmAddEditCtrl.isImageSelectableInEditMode(app)"
                                                           data-ng-model="VmAddEditCtrl.model.imageId">
                                                </flat-radio>
                                            </td>
                                            <td class="no-space top-space-p8 bottom-space-p8" style="width: 50px;">
                                                <img class="img-circle img-circle-bordered" width="50" height="50"
                                                     data-ng-src="assets/images/cloud/apps/{{:: app.applications[0] }}.png"
                                                     onerror="this.src='assets/images/cloud/apps/unknown.png'"
                                                     alt="{{:: app.applications[0] }}" />
                                            </td>
                                            <td>
                                                <label for="{{::app.id}}" class="fs14 no-space normal">
                                                    <span data-ng-bind="::app.name"></span>
                                                    <small class="text-muted inline-block"
                                                           data-ng-if="app.type === 'windows' && app.price[VmAddEditCtrl.vmInEdition.flavor.groupName]"
                                                           translate="cpcivm_addedit_win_image_price_full"
                                                           translate-values="{price: app.price[VmAddEditCtrl.vmInEdition.flavor.groupName].price.text || '?', monthly: app.price[VmAddEditCtrl.vmInEdition.flavor.groupName].monthlyPrice.text || '?' }">
                                                    </small>
                                                </label>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </uib-accordion-group>

                            <!-- SNAPSHOT  -->
                            <!-- class instead of ng-class un uib-accordion-group is a known issues over of angular-ui-bootsrap -->
                            <uib-accordion-group data-is-open="VmAddEditCtrl.toggle.accordions.images.snapshots"
                                class="{{VmAddEditCtrl.toggle.accordions.images.snapshots ? 'active': ''}}">

                                <uib-accordion-heading>
                                    <span data-translate="cpcivm_addedit_image_snapshots"></span>

                                    <div class="chevron-right">
                                        <i class="glyphicon pull-right" ng-class="{'glyphicon-chevron-down': VmAddEditCtrl.toggle.accordions.images.snapshots, 'glyphicon-chevron-right': !VmAddEditCtrl.toggle.accordions.images.snapshots}"></i>
                                    </div>
                                </uib-accordion-heading>

                                <table class="table table-pretty table-hover table-striped shadow-z-1">
                                    <tbody data-ng-if="VmAddEditCtrl.displayData.snapshots.length === 0">
                                        <tr>
                                            <td data-translate="cpcivm_addedit_image_snapshots_empty"></td>
                                        </tr>
                                    </tbody>
                                    <tbody data-ng-if="VmAddEditCtrl.displayData.snapshots.length > 0">
                                        <tr data-ng-repeat="snapshot in VmAddEditCtrl.displayData.snapshots track by snapshot.id"
                                            data-ng-click="VmAddEditCtrl.model.imageId = snapshot.disabled ? VmAddEditCtrl.model.imageId : snapshot.id"
                                            data-ng-class="{'disabled opacity5': snapshot.disabled || snapshot.deprecated }"
                                            class="pointer" role="button" tabindex="0" cuc-click-enter-on-keypress
                                            data-uib-tooltip="{{:: snapshot.disabled ? ('cpcivm_addedit_image_disabled_' + snapshot.disabled | translate) : (snapshot.deprecated ? ('cpcivm_addedit_image_deprecated' | translate) : '') }}">

                                            <td style="width: 50px;">
                                                <flat-radio>
                                                    <input type="radio" aria-hidden="true" tabindex="-1"
                                                           name="imagesChoice" id="{{::snapshot.id}}"
                                                           data-ovh-stop-event="click"
                                                           value="{{::snapshot.id}}"
                                                           data-ng-disabled="snapshot.disabled"
                                                           data-ng-model="VmAddEditCtrl.model.imageId">
                                                </flat-radio>
                                            </td>
                                            <td class="no-space top-space-p8 bottom-space-p8" style="width: 50px;">
                                                <div class="img-snapshot">
                                                    <i class="fa fa-{{snapshot.type}}"></i>
                                                </div>
                                            </td>
                                            <td>
                                                <label for="{{::snapshot.id}}" class="fs14 no-space normal">
                                                    <span data-ng-bind="::snapshot.name"></span>
                                                    <small class="text-muted inline-block"
                                                           data-ng-if="snapshot.type === 'windows' && snapshot.price[VmAddEditCtrl.vmInEdition.flavor.groupName]"
                                                           translate="cpcivm_addedit_win_image_price_full"
                                                           translate-values="{price: snapshot.price[VmAddEditCtrl.vmInEdition.flavor.groupName].price.text || '?', monthly: snapshot.price[VmAddEditCtrl.vmInEdition.flavor.groupName].monthlyPrice.text || '?' }">
                                                    </small>
                                                </label>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </uib-accordion-group>

                        </uib-accordion>

                    </div>
                </div>

                <!-- ___ REGIONS ___ -->

                <div data-ng-switch-when="regions" class="animate-switch">

                    <h3 class="title text-center"
                        data-ng-if="VmAddEditCtrl.isSwitchMode()"
                        data-translate="cpcivm_addedit_change_region_title">
                    </h3>

                    <!-- loading... -->
                    <p data-ng-if="VmAddEditCtrl.loaders.panelsData.regions"
                       class="popover-detail-item text-center">
                        <spinner></spinner>
                        {{:: 'cpcivm_addedit_region_loading' | translate}}
                    </p>


                    <!-- content -->
                    <div data-ng-if="!VmAddEditCtrl.loaders.panelsData.regions">


                        <!-- no datas -->
                        <p class="popover-detail-item text-center" data-ng-if="!VmAddEditCtrl.panelsData.regions.length">
                            <i class="fa fa-bug"></i>
                            <span translate="cpcivm_addedit_region_error"></span>
                            <br><br>
                            <button type="button" class="btn btn-secondary" data-ng-click="VmAddEditCtrl.getRegions()">
                                <i class="glyphicon glyphicon-refresh"></i>
                                <span translate="cpcivm_addedit_region_refresh"></span>
                            </button>
                        </p>

                        <p class="text-muted inline-block red space-m16 fs10"
                               data-ng-if="VmAddEditCtrl.model.imageType === 'SNAPSHOT'"
                               translate="cpcivm_addedit_region_snapshot_change">
                        </p>

                        <uib-accordion close-others="true"
                            data-ng-if="VmAddEditCtrl.panelsData.regions.length">

                            <!-- class instead of ng-class un uib-accordion-group is a known issues over of angular-ui-bootsrap -->
                            <uib-accordion-group data-is-open="VmAddEditCtrl.toggle.accordions.regions.public"
                                class="{{VmAddEditCtrl.toggle.accordions.regions.public ? 'active' : '' }}">

                                <uib-accordion-heading>
                                    <span data-translate="cpcivm_addedit_region_zone_public"></span>

                                    <div class="chevron-right">
                                        <i class="glyphicon pull-right" ng-class="{'glyphicon-chevron-down': VmAddEditCtrl.toggle.accordions.regions.public, 'glyphicon-chevron-right': !VmAddEditCtrl.toggle.accordions.regions.public}"></i>
                                    </div>
                                </uib-accordion-heading>

                                <table class="table table-pretty table-hover table-striped shadow-z-1">
                                    <tbody>

                                        <tr data-ng-repeat="region in VmAddEditCtrl.panelsData.regions"
                                            data-ng-click="VmAddEditCtrl.model.region = region"
                                            class="pointer" role="button" tabindex="0" cuc-click-enter-on-keypress>

                                            <td style="width: 50px;">
                                                <flat-radio>
                                                    <input type="radio" aria-hidden="true" tabindex="-1"
                                                           name="regionsChoice" id="{{::region}}"
                                                           data-ovh-stop-event="click"
                                                           value="{{::region}}"
                                                           data-ng-model="VmAddEditCtrl.model.region">
                                                </flat-radio>
                                            </td>
                                            <td class="space-p8 flag-box flag-box-cell" style="width: 50px;">
                                                <div class="popover-list-item">
                                                    <div class="popover-list-item-illustration">
                                                        <i class="flag-icon {{:: VmAddEditCtrl.regionService.getRegionIconFlag(region) }} flag"></i>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="left-space-p4">
                                                <span class="fs14 no-space normal col-xs-12" data-ng-bind="::VmAddEditCtrl.regionService.getTranslatedMicroRegion(region)"></span>
                                                <span class="fs10 no-space col-xs-12">
                                                    {{ VmAddEditCtrl.regionService.getTranslatedMicroRegionLocation(region) }}
                                                    <a class="left-space-m8"
                                                       href="{{ region | openStreetMap }}"
                                                       target="_blank"
                                                       data-ng-if="region | openStreetMap"
                                                       data-ng-click="$event.stopPropagation()">
                                                        {{ 'cloud_common_region_localize' | translate }}<i class="fa fa-map-marker fs14 left-space-m4"></i>
                                                    </a>
                                                </span>
                                            </td>
                                        </tr>

                                    </tbody>
                                </table>

                            </uib-accordion-group>
                        </uib-accordion>

                        <!-- <br><br>
                        <div class="popover-detail-item text-center" style="margin-top: 5px;">
                            <img data-ng-if="VmAddEditCtrl.model.region" data-ng-src="assets/images/cloud/common/{{VmAddEditCtrl.model.region}}_map_selected.jpg" alt="">
                        </div> -->
                    </div>
                </div>

                <!-- ___ ADVANCED OPTIONS ___ -->
                <div data-ng-switch-when="advanced" class="animate-switch">

                    <h3 class="title text-center"
                        data-ng-if="VmAddEditCtrl.isSwitchMode()"
                        data-translate="cpcivm_addedit_advanced_options_title">
                    </h3>

                    <!-- MULTIPLE INSTANCE CREATION -->
                    <div class="popover-detail-item animate-show-opacity">
                        <p class="no-space bottom-space-p8">
                            <strong data-translate="cpcivm_addedit_advanced_options_multiple_creation"></strong>
                        </p>
                        <form class="ovh-form-flat" id="vmCountForm" name="vmCountForm" data-ng-init="VmAddEditCtrl.model.vmCount = VmAddEditCtrl.model.vmCount || 1">
                            <div flat-input-container>
                                <label for="vmCount" data-translate="cpcivm_addedit_advanced_options_multiple_creation_count"></label>
                                <input type="number"
                                class="form-control error-animate-shake-light"
                                id="vmCount"
                                label="vmCount"
                                data-ng-model="VmAddEditCtrl.model.vmCount"
                                data-ng-disabled="VmAddEditCtrl.getMaximumInstanceCreationCount() <= 1"
                                required
                                min="1"
                                max="{{ VmAddEditCtrl.getMaximumInstanceCreationCount() }}" />
                            </div>
                            <p class="text-danger" data-ng-if="!vmCountForm.$valid" data-translate="cpcivm_addedit_advanced_options_multiple_creation_count_error"></p>
                            <p class="no-space text-left top-space-m16"
                               translate-compile
                               data-ng-if="VmAddEditCtrl.getMaximumInstanceCreationCount() > 1"
                               data-translate="cpcivm_addedit_advanced_options_multiple_creation_infos"
                               data-translate-values="{
                                   max: VmAddEditCtrl.getMaximumInstanceCreationCount(),
                                   type: VmAddEditCtrl.vmInEdition.flavor.name,
                                   region: VmAddEditCtrl.vmInEdition.region,
                                   sref: 'iaas.pci-project.compute.quota'
                               }"></p>
                            <p class="no-space text-left top-space-m16"
                               translate-compile
                               data-ng-if="VmAddEditCtrl.getMaximumInstanceCreationCount() <= 1"
                               data-translate="cpcivm_addedit_advanced_options_multiple_creation_infos_error"
                               data-translate-values="{
                                   max : VmAddEditCtrl.getMaximumInstanceCreationCount(),
                                   type : VmAddEditCtrl.vmInEdition.flavor.name,
                                   region : VmAddEditCtrl.vmInEdition.region,
                                   sref: 'iaas.pci-project.compute.quota'
                               }"></p>
                        </form>
                    </div>

                    <!-- POST INSTALL SCRIPT -->
                    <div class="popover-detail-item animate-show-opacity top-space-m8" data-ng-if="VmAddEditCtrl.vmInEdition.image.type !== 'windows'">
                        <p class="no-space bottom-space-p8">
                            <strong><span data-translate="cpcivm_addedit_change_script_title"></span>&nbsp;:</strong>
                        </p>
                        <div flat-input-container class="top-space-m8">
                            <textarea class="form-control error-animate-shake-light vertical-resize code"
                                name="scriptKeyAddKey" id="scriptKeyAddKey"
                                rows="15"
                                placeholder="{{:: 'cpcivm_addedit_script_key' | translate}}"
                                data-ng-model="VmAddEditCtrl.vmInEdition.userData"
                                required ></textarea>
                        </div>
                    </div>

                    <!-- PRIVATE NETWORK ASSOCIATION -->
                    <form name="privateNetwork" id="privateNetworkForm" novalidate>
                        <fieldset class="popover-detail-item container">
                            <div class="form-group" data-ng-show="VmAddEditCtrl.hasVrackSupport()">
                                <label class="control-label" for="vlandId">
                                    <strong>{{ ::"cpcivm_addedit_advanced_options_private_network_associate_label" | translate }} :</strong>
                                </label>
                                <span class="fa fa-spin fa-circle-o-notch" data-ng-if="VmAddEditCtrl.loaders.privateNetwork.query"></span>
                                <select name="vlandId" id="vlanId" class="form-control" data-ng-model="VmAddEditCtrl.vmInEdition.networkId">
                                    <option data-ng-repeat="network in VmAddEditCtrl.getPrivateNetworks() track by network.vlanId" value="{{ ::network.id }}">
                                        {{ ::network.vlanId }} - {{ ::network.name }}
                                    </option>
                                    <option value="" data-translate="cpcivm_addedit_advanced_options_private_network_default_option"></option>
                                </select>
                                <span class="help-block pull-right"
                                    data-translate="cpcivm_addedit_advanced_options_private_network_api_guide"
                                    data-translate-values="{ url: VmAddEditCtrl.getVlansApiGuideUrl() }">
                                </span>
                            </div>
                            <div class="disabled-feature row" data-ng-show="!VmAddEditCtrl.hasVrackSupport()">
                                <div class="col-xs-12">
                                    <p data-translate="cpci_vrack_vlan_more_information"
                                       data-translate-values="{ url: VmAddEditCtrl.getVlansGuideUrl() }">
                                    </p>
                                </div>
                                <div class="col-xs-5 pull-right">
                                    <a class="btn btn-primary btn-block"
                                        data-translate="cpci_vrack_create_button"
                                        data-ui-sref="vrack-home"
                                        title="{{ ::cpci_vrack_create_button | translate }}">
                                    </a>
                                </div>
                            </div>
                        </fieldset>
                    </form>

                </div>

                <!-- ___ SSHKEYS ___ -->

                <div data-ng-switch-when="sshKeys" class="animate-switch">

                    <h3 class="title text-center"
                        data-ng-if="VmAddEditCtrl.isSwitchMode()"
                        data-translate="cpcivm_addedit_change_sshkey_title">
                    </h3>

                    <div class="popover-detail-item animate-show-opacity">

                        <div ng-slide-down="!VmAddEditCtrl.toggle.openAddSshKey" duration="0.3">
                            <button class="btn btn-primary" type="button"
                                    data-ng-click="VmAddEditCtrl.toggleAddSshKey()">
                                <i class="glyphicon glyphicon-plus right-space-m8"></i>
                                <span translate="cpcivm_addedit_sshkey_add_button"></span>
                            </button>

                            <div class="btn btn-link pull-right"
                                 data-translate="cpcivm_addedit_sshkey_guide"
                                 data-translate-values="{ createUrl: VmAddEditCtrl.getCreateSshKeysGuideUrl() }">
                            </div>
                        </div>

                        <!-- Form sshKeyFormAdd -->
                        <div class="animate-fadeInDown-enter animate-fadeOutUp-leave"
                            ng-slide-down="VmAddEditCtrl.toggle.openAddSshKey" lazy-render duration="0.3">

                            <h4 class="text-center bold" translate="cpcivm_addedit_sshkey_add_button"></h4>
                            <hr>
                            <div data-ng-if="VmAddEditCtrl.projectHasNoSshKeys()">
                                <p>
                                    <strong data-translate="cpcivm_addedit_sshkey_none"></strong>
                                </p>
                                <p data-translate="cpcivm_addedit_ssh_key_explain_1"></p>
                                <p data-translate="cpcivm_addedit_ssh_key_explain_2"
                                   data-translate-values="{createUrl: VmAddEditCtrl.getCreateSshKeysGuideUrl()}">
                                </p>
                            </div>

                            <form name="sshKeyFormAdd" class="ovh-form-flat">
                                <div flat-input-container>
                                    <label for="sshKeyAddName" translate="cpcivm_addedit_sshkey_name"></label>
                                    <input type="text" class="form-control error-animate-shake-light"
                                           id="sshKeyAddName" name="sshKeyAddName"
                                           placeholder="{{:: 'cpcivm_addedit_sshkey_name' | translate}}"
                                           data-ng-disabled="VmAddEditCtrl.loaders.sshKey.add"
                                           data-ng-model="VmAddEditCtrl.sshKeyAdd.name"
                                           required
                                           ng-pattern="/^[\w\-\s]+$/"
                                           ng-maxlength="255"
                                           cuc-autofocus>
                                </div>

                                <div class="left-space-p8 right-space-p8" ng-messages="sshKeyFormAdd.sshKeyAddName.$error" data-ng-if="sshKeyFormAdd.sshKeyAddName.$dirty">
                                    <p class="text-danger animate-fadeInLeft-enter animate-fadeOutRight-leave" ng-message="required"><span translate="cpcivm_addedit_sshkey_add_error_required_name"></span></p>
                                    <p class="text-danger animate-fadeInLeft-enter animate-fadeOutRight-leave" ng-message="maxlength"><span translate="cpcivm_addedit_sshkey_add_error_max_char"></span></p>
                                    <p class="text-danger animate-fadeInLeft-enter animate-fadeOutRight-leave" ng-message="pattern"><span translate="cpcivm_addedit_sshkey_add_error_pattern_name"></span></p>
                                </div>

                                <div flat-input-container class="top-space-m8">
                                    <label for="sshKeyAddKey" translate="cpcivm_addedit_sshkey_key"></label>
                                    <textarea class="form-control error-animate-shake-light vertical-resize"
                                        name="sshKeyAddKey" id="sshKeyAddKey"
                                        rows="3"
                                        placeholder="{{:: 'cpcivm_addedit_sshkey_key' | translate}}"
                                        data-ng-disabled="VmAddEditCtrl.loaders.sshKey.add"
                                        data-ng-model="VmAddEditCtrl.sshKeyAdd.publicKey"
                                        required ></textarea>
                                </div>

                                <div class="left-space-p8 right-space-p8" ng-messages="sshKeyFormAdd.sshKeyAddKey.$error" data-ng-if="sshKeyFormAdd.sshKeyAddKey.$dirty">
                                    <p class="text-danger animate-fadeInLeft-enter animate-fadeOutRight-leave" ng-message="required"><span translate="cpcivm_addedit_sshkey_add_error_required_key"></span></p>
                                </div>

                                <div class="top-space-m12 clearfix">
                                    <button type="submit" class="btn btn-primary pull-right"
                                        data-ng-disabled="sshKeyFormAdd.$invalid"
                                        data-ng-click="VmAddEditCtrl.postSshKey()">
                                        <i class="glyphicon glyphicon-ok right-space-m8"></i>
                                        <span translate="cpcivm_addedit_sshkey_add_submit"></span>
                                        <spinner name="bubbles-fff-ffcd1a-16" data-ng-if="VmAddEditCtrl.loaders.sshKey.add"></spinner>
                                    </button>
                                    <button type="reset" class="btn btn-default pull-left"
                                        data-ng-disabled="VmAddEditCtrl.loaders.sshKey.add"
                                        data-ng-click="VmAddEditCtrl.toggleAddSshKey()">
                                        <i class="glyphicon glyphicon-remove right-space-m8"></i>
                                        <span translate="cpcivm_addedit_sshkey_add_button_cancel"></span>
                                    </button>
                                </div>
                            </form>
                            <hr>
                        </div>

                        <!-- sshKeys table -->
                        <table class="table table-pretty table-hover table-striped top-space-m8 shadow-z-1"
                               data-ng-if="!VmAddEditCtrl.projectHasNoSshKeys()">
                            <thead>
                                <tr>
                                    <th style="width: 50px;"></th>
                                    <th data-translate="cpcivm_addedit_sshkey_name"></th>
                                    <th class="text-center" style="width: 50px;">
                                        <button class="no-style" type="button"
                                            data-ng-click="VmAddEditCtrl.getSshKeys(true)"
                                            title="{{:: 'cpcivm_addedit_sshkey_refresh_button' | translate}}">
                                            <i class="glyphicon glyphicon-refresh"></i>
                                        </button>
                                    </th>
                                </tr>
                            </thead>
                            <tbody data-ng-if="VmAddEditCtrl.loaders.panelsData.sshKeys">
                                <tr>
                                    <td colspan="3" class="text-center">
                                        <spinner></spinner>
                                    </td>
                                </tr>
                            </tbody>
                            <tbody data-ng-if="!VmAddEditCtrl.loaders.panelsData.sshKeys && VmAddEditCtrl.panelsData.sshKeys === null">
                                <tr>
                                    <td colspan="3" class="text-center">
                                        <i class="fa fa-bug"></i>
                                        <span translate="cpcivm_addedit_sshkey_error"></span>
                                        <button type="button" class="btn btn-default" data-ng-click="VmAddEditCtrl.getSshKeys(true)">
                                            <i class="glyphicon glyphicon-refresh white"></i>
                                            <span translate="cpcivm_addedit_sshkey_refresh_button"></span>
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                            <tbody data-ng-hide="VmAddEditCtrl.loaders.panelsData.sshKeys">
                                <tr data-ng-repeat="sshKey in VmAddEditCtrl.displayData.sshKeys | orderBy:'name'"
                                    data-ng-click="VmAddEditCtrl.model.sshKeyId = sshKey.id"
                                    data-ng-show="sshKey.availableOnRegion"
                                    class="pointer">

                                    <td data-ng-hide="VmAddEditCtrl.sshKeyDeletedId === sshKey.id">
                                        <flat-radio>
                                            <input type="radio"
                                                    value="{{::sshKey.id}}" id="{{::sshKey.id}}"
                                                    name="ssh_choice"
                                                    data-ovh-stop-event="click"
                                                    data-ng-disabled="VmAddEditCtrl.sshKeyDeletedId"
                                                    data-ng-model="VmAddEditCtrl.model.sshKeyId"/>
                                        </flat-radio>
                                    </td>

                                    <td data-ng-hide="VmAddEditCtrl.sshKeyDeletedId === sshKey.id" class="word-break">
                                        <p class="no-space">
                                            <button class="no-style" type="button"
                                                data-ovh-stop-event="click"
                                                data-ng-click="sshKeyFull = !sshKeyFull">
                                                <i class="fa fa-caret-right rotate" data-ng-class="{'rotate90' : sshKeyFull}"></i>
                                            </button>
                                            <label for="{{::sshKey.id}}" class="no-space normal"
                                                    data-ng-bind="::sshKey.name"></label>
                                        </p>
                                        <div ng-slide-down="sshKeyFull" duration="0.3" lazy-render>
                                            <p class="no-space"
                                                data-ovh-stop-event="click"
                                                data-ng-bind="::sshKey.publicKey"></p>
                                        </div>
                                    </td>

                                    <td data-ng-hide="VmAddEditCtrl.sshKeyDeletedId === sshKey.id">
                                        <button class="no-style" type="button" data-ovh-stop-event="click"
                                            data-ng-click="VmAddEditCtrl.sshKeyDeletedId = sshKey.id"
                                            data-ng-disabled="VmAddEditCtrl.sshKeyDeletedId && VmAddEditCtrl.sshKeyDeletedId !== sshKey.id"
                                            title="{{:: 'cpcivm_addedit_sshkey_delete_button' | translate}}">
                                            <i class="glyphicon glyphicon-trash"></i>
                                        </button>
                                    </td>

                                    <td colspan="3" class="text-center" data-ng-if="VmAddEditCtrl.sshKeyDeletedId === sshKey.id">
                                        <div class="animated fadeInRight">
                                            <button class="btn btn-default" type="reset"
                                                data-ovh-stop-event="click"
                                                data-ng-disabled="VmAddEditCtrl.loaders.sshKey.remove"
                                                data-ng-click="VmAddEditCtrl.sshKeyDeletedId = null">
                                                <i class="glyphicon glyphicon-remove right-space-m8"></i>
                                                <span translate="cpcivm_addedit_sshkey_delete_cancel"></span>
                                            </button>
                                            <button class="btn btn-danger" type="submit"
                                                data-ovh-stop-event="click" cuc-autofocus
                                                data-ng-click="VmAddEditCtrl.deleteSshKey(sshKey.id)">
                                                <i data-ng-hide="VmAddEditCtrl.loaders.sshKey.remove" class="glyphicon glyphicon-trash right-space-m8"></i>
                                                <spinner name="bubbles-fff-d34936-16" data-ng-if="VmAddEditCtrl.loaders.sshKey.remove"></spinner>
                                                <span translate="cpcivm_addedit_sshkey_delete_submit"></span>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <tr ng-show="VmAddEditCtrl.displayData.sshKeyUnavailables">
                                    <td colspan="3" class="text-center well well-sm low-padding">
                                        <p class="text-center text-muted fs11 no-space"
                                           data-ng-init="translateValues = {count : VmAddEditCtrl.displayData.sshKeyUnavailables, region : VmAddEditCtrl.regionService.getTranslatedMicroRegion(VmAddEditCtrl.vmInEdition.region)}">
                                           {{ :: VmAddEditCtrl.displayData.sshKeys.outRegion.length > 1 ? ('cpcivm_add_ssh_key_out_region_plural' | translate:translateValues) : ('cpcivm_add_ssh_key_out_region' | translate:translateValues) }}
                                        </p>
                                    </td>
                                </tr>
                                <tr data-ng-repeat="sshKey in VmAddEditCtrl.displayData.sshKeys | orderBy:'name'"
                                    data-ng-hide="sshKey.availableOnRegion"
                                    data-ng-click="VmAddEditCtrl.sshKeyAddRegion(sshKey)"
                                    data-uib-tooltip="{{cpcivm_addedit_sshkey_add_button | translate}}">
                                    <td>
                                        <flat-radio>
                                            <input type="radio"
                                                    value="{{::sshKey.id}}"
                                                    name="ssh_choice"
                                                    >
                                        </flat-radio>
                                    </td>

                                    <td colspan="2" class="word-break">
                                        <p class="no-space">
                                            <button class="no-style" type="button"
                                                data-ovh-stop-event="click"
                                                data-ng-click="sshKeyFull = !sshKeyFull">
                                                <i class="fa fa-caret-right rotate" data-ng-class="{'rotate90' : sshKeyFull}"></i>
                                            </button>
                                            <label for="{{::sshKey.id}}" class="no-space normal"
                                                    data-ng-bind="::sshKey.name"></label>
                                        </p>
                                        <div ng-slide-down="sshKeyFull" duration="0.3" lazy-render>
                                            <p class="no-space"
                                                data-ng-bind="::sshKey.publicKey"></p>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- ___ SSHKEY HELP ___ -->

                <div data-ng-switch-when="sshKeys-help" class="animate-switch sshkey-help">

                    <h3 class="title text-center"
                        data-ng-if="VmAddEditCtrl.isSwitchMode()"
                        data-translate="cpcivm_addedit_change_sshkey_title">
                    </h3>

                    <div class="animate-show-opacity">
                        <button class="btn btn-default" type="button"
                                data-ng-click="VmAddEditCtrl.openEditDetail('sshKeys')">
                            <i class="fa fa-chevron-left right-space-m8"></i>
                            <span translate="cpcivm_addedit_sshkey_help_back_button"></span>
                        </button>

                        <tabset class="cloud-classic-tabs top-space-m12 bottom-space-m12">
                            <tab>
                                <tab-heading>
                                    <span translate="cpcivm_addedit_sshkey_help_linuxmac_tab"></span>
                                </tab-heading>

                                <p translate="cpcivm_addedit_sshkey_help_linuxmac_paragraph_beforeAll"></p>
                                <p translate="cpcivm_addedit_sshkey_help_linuxmac_paragraph_openbash"></p>
                                <pre>ls ~/.ssh</pre>
                                <p translate="cpcivm_addedit_sshkey_help_linuxmac_paragraph_getGoodFile"
                                   translate-values="{
                                       rsapriv:'<code>id_rsa</code>',
                                       rsapub:'<code>id_rsa.pub</code>',
                                       dsapriv:'<code>id_dsa</code>',
                                       dsapub:'<code>id_dsa.pub</code>'
                                   }"
                                >
                                </p>
                                <p translate="cpcivm_addedit_sshkey_help_linuxmac_paragraph_generateKeypair"></p>
                                <pre>ssh-keygen -b 4096 -t rsa</pre>
                                <p translate="cpcivm_addedit_sshkey_help_linuxmac_paragraph_options"></p>
                                <p translate="cpcivm_addedit_sshkey_help_linuxmac_paragraph_startingFrom"></p>
                                <p translate="cpcivm_addedit_sshkey_help_linuxmac_paragraph_privateKey"
                                   translate-values="{
                                        dirrsapriv:'<code>~/.ssh/id_rsa</code>'
                                    }"></p>
                                <p translate="cpcivm_addedit_sshkey_help_linuxmac_paragraph_publicKey"
                                   translate-values="{
                                       dirrsapub:'<code>~/.ssh/id_rsa.pub</code>'
                                   }"></p>
                            </tab>

                            <tab>
                                <tab-heading>
                                    <span translate="cpcivm_addedit_sshkey_help_windows_tab"></span>
                                </tab-heading>

                                <p translate="cpcivm_addedit_sshkey_help_window_paragraph_usePutty"></p>
                                <p translate="cpcivm_addedit_sshkey_help_window_paragraph_generateKeypair"></p>

                                <img src="assets/images/cloud/common/ssh/help/windows_putty_interface.png"
                                    alt="Putty interface" style="width: 100%;" />

                                <p translate="cpcivm_addedit_sshkey_help_window_paragraph_saveKeypair"></p>
                            </tab>
                        </tabset>

                        <button class="btn btn-default" type="button"
                                data-ng-click="VmAddEditCtrl.openEditDetail('sshKeys')">
                            <i class="fa fa-chevron-left right-space-m8"></i>
                            <span translate="cpcivm_addedit_sshkey_help_back_button"></span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
